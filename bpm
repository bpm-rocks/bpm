#!/usr/bin/env bash
# Bash Package Manager (BPM)
BPM_VERSION="1.0.0"
BPM_BUILD_DATE="2017-11-13T15:17:09+00:00"
BPM_GLOBAL_PATH=/usr/lib/bpm-modules

# Includes a library that was installed via `bpm install`.
#
# $1 - Name of library to include.
#
# Starting at the current script's folder, this scans all parent folders
# for a `bpm` directory that contains the include file for the
# library. If that fails to find a hit, then the user's installed libraries
# and system installed libraries are checked.
#
# Returns true (0) if the library loaded successfully. Returns 1 when unable
# to locate the library or when the library doesn't `source` without errors.
# Returns 2 if no module name is specified.
bpm::include() {
    local cachedVarName dir oldPwd

    if [[ -z "${1-}" ]]; then
        echo "No module name specified." >&2

        return 2
    fi

    cachedVarName="bpm_include_$1"
    cachedVarName=${cachedVarName//-/_}

    if [[ -n "${!cachedVarName-}" ]]; then
        # Already loaded
        return 0
    fi

    # This next block is equivalent to shelling out to call `dirname`, but
    # is roughly twice as fast. It changes things like "file" into ".", but
    # anything with paths ("./file", "../file", "/dir/file") have the last
    # slash removed as well as everything afterwards.
    #
    # Do not use path::dirname because that library hasn't been loaded yet.
    dir=${BASH_SOURCE[1]}

    if [[ "$dir" == */* ]]; then
        dir=${dir%/*}
    else
        dir=.
    fi

    # Resolve ".." and similar things into a full path. Much faster than
    # the alternative: `dir="$(cd "$dir"; pwd)"`
    # Please pay special attention to the extra slash at the end of $dir.
    oldPwd=$PWD
    cd "$dir"
    dir="$PWD/"
    cd "$oldPwd"

    # Scan every folder and their parents until we're at the root.
    # This loop is a bit weird because we started with an extra slash added
    # to $dir. That lets us remove the last element from $dir with each loop
    # and still scan the root directory when we run out of other parents.
    while [[ -n "$dir" ]]; do
        dir=${dir%/*}

        bpm::includeAttempt "$cachedVarName" "$dir/bpm-modules/.include/$1" && return 0
    done

    # Check in a user's module folder.
    bpm::includeAttempt "$cachedVarName" ~/.bpm/.include/"$1" && return 0

    # Check for a library on the system.
    # Could use ${BASH_SOURCE[0]} for the location of bpm if we want to use
    # a relative path.
    bpm::includeAttempt "$cachedVarName" "$BPM_GLOBAL_PATH/.include/$1" && return 0

    echo "BPM include not found: $1" >&2

    return 1
}


# Tries to include a library at a given path. Used strictly by bpm::include
# to attempt to load a module.
#
# $1 - Variable to assign if the library is loaded.
# $2 - Full path of library to load.
#
# Returns true (0) if the library loaded successfully. Returns 1 if the
# library does not exist. Returns 2 if there was an error during the load
# of a library.
bpm::includeAttempt() {
    [[ -f "$2" ]] || return 1
    . "$2" || return 2

    # shellcheck disable=SC2059
    printf -v "$1" "$2"
}


# Determine if the script is being sourced.
#
# Examples
#
#   mycommand() {
#       # This function can be sourced or executed as a command.
#   }
#
#   if bpm::isSourced; then
#       mycommand "$@"
#   fi
#
# Returns true (0) when sourced, false otherwise.
bpm::isSourced() {
    [[ "${FUNCNAME[1]-}" == "source" ]]
}


# Do not execute anything further when we are sourced.
bpm::isSourced && return

bpm_include_is=$0
#!/usr/bin/env bash

# Determine if a given environment variable exists and if it is an array.
#
# $1 - Name of environment variable.
#
# Examples
#
#   var=(abc)
#
#   if is::array var; then
#       echo "This is an array"
#       echo "Be careful to use the variable's name in the function call."
#   fi
#
#   right=wrong
#   wrong=()
#
#   if is::array $right; then
#       echo "This also says it is an array, which is incorrect."
#       echo 'The correct call is `is::array right` without the $.'
#   fi
#
# Returns true (0) if the named variable exists and if it is an array.
# Returns false (1) otherwise.
is::array() {
    [[ "$(declare -p "$1" 2> /dev/null)" == "declare -"[aA]* ]]
}


# Determine if the given name is a defined function.
#
# $1 - Function name to check.
#
# Examples
#
#   moo () {
#       echo "This is a function"
#   }
#
#   if is::function moo; then
#       echo "moo is a defined function"
#   fi
#
# Returns true (0) if the name is a function, false (1) otherwise.
is::function() {
    local functionList functionName

    functionList=$(declare -F)
    functionList=( ${functionList//declare -f /} )

    for functionName in "${functionList[@]}"; do
        if [[ "$functionName" == "$1" ]]; then
            return 0
        fi
    done

    return 1
}


# Determine if a variable is assigned, even if it is assigned an empty value.
#
# $1 - Variable name to check.
#
# Examples
#
#   unset abc
#
#   if ! is::set abc; then
#       echo "The variable is not set"
#   fi
#
#   abc=""
#
#   if is::set abc; then
#       echo "This is true, the variable is set"
#   fi
#
# Returns true (0) if the variable is set, false (1) if the variable is unset.
is::set() {
    [[ "${!1-a}" == "${!1-b}" ]]
}
bpm_include_assign=$0
#!/usr/bin/env bash

# Array Splitting
# ---------------
#
# IFS must be set to a string containing space or unset in order for
# the array slicing to work regardless of the current IFS setting on
# bash 3.  This is detailed further at
# https://github.com/fidian/gg-core/pull/7

. bpm
bpm::include is

# Send an array as a variable up to caller of a function. It is best used
# with some odd syntax as shown in the example, which preserves empty arrays.
#
# $1   - Variable name
# $2-@ - Array elements
#
# Examples
#
#   callFunc () {
#       local myArray=(one two three)
#       local "${1-}" && assign::array "$1" ${myArray[@]+"${myArray[@]}"}
#   }
#   callFunc dest
#   echo "${dest[@]}" # writes "one two three"
#
# Returns nothing.
assign::array() {
    unset -v "$1"

    # Must set IFS - see the "Array Splitting" discussion.
    eval "$(printf "IFS= %s=(\"\${@:2}\") IFS=%q" "$1" "$IFS")"
}


# Assigns a value by reference.
#
# $1 - Destination variable name.
# $2 - Source variable name.
#
# Copies an array or scalar to the destination. This can be much simpler than
# assigning arrays. See the example for further information.
#
# Examples
#
#   # Copy a value
#   a="a string"
#   assign::byRef b a
#   echo "$b"  # "a string"
#
#   # Copy an array with an unknown number of elements (even zero)
#   # Replace "..." with zero or more elements.
#   theArray=( ... )
#   assign::byRef theArrayCopy theArray
#   set | grep ^theArray
#   # This shows the array was copied
#
#   # Copies an unset value as well.
#   unset unsetValue
#   unsetValueCopy=something
#   assign::byRef unsetValueCopy unsetValue
#   set | grep ^unsetValue
#   # Neither shows up.
#
# Returns nothing.
assign::byRef() {
    unset -v "$1"

    if is::array "$2"; then
        # Must set IFS - see the "Array Splitting" discussion.
        eval "assign::array \"$1\" \${$2[@]+\"\${$2[@]}\"}"
    elif [[ -n "${!2+_}" ]]; then
        # If there is a value, copy it.
        printf -v "$1" '%s' "${!2}"
    fi
}


# Send a variable up to the parent of the caller of this function.
#
# $1 - Variable name.
# $2 - Value to assign.
#
# Examples
#
#   callFunc() {
#       local dest
#       dest="Just an example to prove the local variable is overwritten"
#       local "${1-}" && assign::value "$1" "the value"
#   }
#
#   dest="value from target scope, ignored"
#   callFunc dest
#   echo "$dest"  # writes "the value"
#
# Returns nothing.
assign::value() {
    unset -v "$1"
    printf -v "$1" '%s' "${2-}"
}
bpm_include_string=$0
#!/usr/bin/env bash

. bpm
bpm::include assign


# Find the first index of a substring.  If not found, sets the index to -1.
#
# $1 - Destination variable for the index
# $2 - Needle
# $3 - Haystack
#
# Returns nothing.
string::indexOf() {
    local pos string

    string=${3%%$2*}
    [[ "$string" == "$3" ]] && pos=-1 || pos=${#string}

    local "${1-}" && assign::value "$1" "$pos"
}


# Prepend a string before each line in a variable.  Also converts all newlines
# to Unix-style newlines in case they weren't that way before.
#
# $1 - Name of variable where the result will be stored.
# $2 - Prefix string to add to the beginning of all lines.
# $3 - The original string.
#
# Example:
#
#   printf -v lines "one\ntwo\n"
#   # lines is three lines with nothing on the third line.
#
#   string::prefixLines result "Look:  " "$lines"
#   # Result is "Look:  one\nLook:  two\nLook:  "
#   # Even the last line is (intentionally) prefixed.
#
# Returns nothing.
string::prefixLines() {
    local output

    output=${3//$'\r\n'/$'\n'}
    output=${output//$'\r'/$'\n'}
    output="$2$output"
    output=${output//$'\n'/$'\n'$2}

    local "${1-}" && assign::value "$1" "$output"
}


# Split a string into an array.
#
# $1 - Destination variable name.
# $2 - The string to split.
# $3 - Optional, the delimeter, defaults to a space.
#
# Examples
#
#   string::split DEST "a b c d"
#   set | grep ^DEST=
#   # DEST=([0]="a" [1]="b" [2]="c" [3]="d")
#
#   string::split DEST "one|two||three|" "|"
#   set | grep ^DEST=
#   # DEST=([0]="one" [1]="two" [2]="" [3]="three" [4]="")
#
# Returns nothing.
string::split() {
    local delim result str target

    target=${1-}
    str=${2-}
    delim=${3:- }
    result=()

    while [[ "$str" != "${str#*$delim}" ]]; do
        result[${#result[@]}]=${str%%${delim}*}
        str=${str#*$delim}
    done

    result[${#result[@]}]=$str

    # shellcheck disable=SC2068
    local "$target" && assign::array "$target" ${result[@]+"${result[@]}"}
}


# Hex encodes a string and writes it to stdout.
#
# $1 - Target variable name for the hex encoded string.
# $2 - The string to encode.
#
# Returns nothing.
string::toHex() {
    local hex pos result

    result=
    pos=0

    while [[ "$pos" -lt "${#2}" ]]; do
        printf -v hex "%02x" "'${2:$pos:1}"
        result+=$hex
        pos=$((pos + 1))
    done

    local "${1-}" && assign::value "$1" "$result"
}


if [[ "${BASH_VERSINFO[0]}" -gt 4 ]] || [[ "${BASH_VERSINFO[0]}" -eq 4 && "${BASH_VERSINFO[1]}" -ge 2 ]]; then
    # Converts a string to lowercase.
    #
    # $1 - Destination variable name.
    # $2 - String to convert.
    #
    # Returns nothing.
    string::toLower() {
        local "${1-}" && assign::value "$1" "${2,,}"
    }
fi


# Converts a string to lowercase. Not locale-aware, but does handle Unicode.
#
# $1 - Destination variable name.
# $2 - String to convert.
#
# Returns nothing.
string::toLowerFallback() {
    local string

    string=$2

    if [[ "$string" != *[^[:ascii:]]* ]]; then
        string=${string//A/a}
        string=${string//B/b}
        string=${string//C/c}
        string=${string//D/d}
        string=${string//E/e}
        string=${string//F/f}
        string=${string//G/g}
        string=${string//H/h}
        string=${string//I/i}
        string=${string//J/j}
        string=${string//K/k}
        string=${string//L/l}
        string=${string//M/m}
        string=${string//N/n}
        string=${string//O/o}
        string=${string//P/p}
        string=${string//Q/q}
        string=${string//R/r}
        string=${string//S/s}
        string=${string//T/t}
        string=${string//U/u}
        string=${string//V/v}
        string=${string//W/w}
        string=${string//X/x}
        string=${string//Y/y}
        string=${string//Z/z}
    else
        string=${string//A/a}
        string=${string//B/b}
        string=${string//C/c}
        string=${string//D/d}
        string=${string//E/e}
        string=${string//F/f}
        string=${string//G/g}
        string=${string//H/h}
        string=${string//I/i}
        string=${string//J/j}
        string=${string//K/k}
        string=${string//L/l}
        string=${string//M/m}
        string=${string//N/n}
        string=${string//O/o}
        string=${string//P/p}
        string=${string//Q/q}
        string=${string//R/r}
        string=${string//S/s}
        string=${string//T/t}
        string=${string//U/u}
        string=${string//V/v}
        string=${string//W/w}
        string=${string//X/x}
        string=${string//Y/y}
        string=${string//Z/z}
        string=${string//Ã€/Ã }
        string=${string//Ã/Ã¡}
        string=${string//Ã‚/Ã¢}
        string=${string//Ãƒ/Ã£}
        string=${string//Ã„/Ã¤}
        string=${string//Ã…/Ã¥}
        string=${string//Ã†/Ã¦}
        string=${string//Ã‡/Ã§}
        string=${string//Ãˆ/Ã¨}
        string=${string//Ã‰/Ã©}
        string=${string//ÃŠ/Ãª}
        string=${string//Ã‹/Ã«}
        string=${string//ÃŒ/Ã¬}
        string=${string//Ã/Ã­}
        string=${string//Ã/Ã®}
        string=${string//Ã/Ã¯}
        string=${string//Ã/Ã°}
        string=${string//Ã‘/Ã±}
        string=${string//Ã’/Ã²}
        string=${string//Ã“/Ã³}
        string=${string//Ã”/Ã´}
        string=${string//Ã•/Ãµ}
        string=${string//Ã–/Ã¶}
        string=${string//Ã˜/Ã¸}
        string=${string//Ã™/Ã¹}
        string=${string//Ãš/Ãº}
        string=${string//Ã›/Ã»}
        string=${string//Ãœ/Ã¼}
        string=${string//Ã/Ã½}
        string=${string//Ã/Ã¾}
        string=${string//Ä€/Ä}
        string=${string//Ä‚/Äƒ}
        string=${string//Ä„/Ä…}
        string=${string//Ä†/Ä‡}
        string=${string//Äˆ/Ä‰}
        string=${string//ÄŠ/Ä‹}
        string=${string//ÄŒ/Ä}
        string=${string//Ä/Ä}
        string=${string//Ä/Ä‘}
        string=${string//Ä’/Ä“}
        string=${string//Ä”/Ä•}
        string=${string//Ä–/Ä—}
        string=${string//Ä˜/Ä™}
        string=${string//Äš/Ä›}
        string=${string//Äœ/Ä}
        string=${string//Ä/ÄŸ}
        string=${string//Ä /Ä¡}
        string=${string//Ä¢/Ä£}
        string=${string//Ä¤/Ä¥}
        string=${string//Ä¦/Ä§}
        string=${string//Ä¨/Ä©}
        string=${string//Äª/Ä«}
        string=${string//Ä¬/Ä­}
        string=${string//Ä®/Ä¯}
        string=${string//Ä°/i}
        string=${string//Ä²/Ä³}
        string=${string//Ä´/Äµ}
        string=${string//Ä¶/Ä·}
        string=${string//Ä¹/Äº}
        string=${string//Ä»/Ä¼}
        string=${string//Ä½/Ä¾}
        string=${string//Ä¿/Å€}
        string=${string//Å/Å‚}
        string=${string//Åƒ/Å„}
        string=${string//Å…/Å†}
        string=${string//Å‡/Åˆ}
        string=${string//ÅŠ/Å‹}
        string=${string//ÅŒ/Å}
        string=${string//Å/Å}
        string=${string//Å/Å‘}
        string=${string//Å’/Å“}
        string=${string//Å”/Å•}
        string=${string//Å–/Å—}
        string=${string//Å˜/Å™}
        string=${string//Åš/Å›}
        string=${string//Åœ/Å}
        string=${string//Å/ÅŸ}
        string=${string//Å /Å¡}
        string=${string//Å¢/Å£}
        string=${string//Å¤/Å¥}
        string=${string//Å¦/Å§}
        string=${string//Å¨/Å©}
        string=${string//Åª/Å«}
        string=${string//Å¬/Å­}
        string=${string//Å®/Å¯}
        string=${string//Å°/Å±}
        string=${string//Å²/Å³}
        string=${string//Å´/Åµ}
        string=${string//Å¶/Å·}
        string=${string//Å¸/Ã¿}
        string=${string//Å¹/Åº}
        string=${string//Å»/Å¼}
        string=${string//Å½/Å¾}
        string=${string//Æ/É“}
        string=${string//Æ‚/Æƒ}
        string=${string//Æ„/Æ…}
        string=${string//Æ†/É”}
        string=${string//Æ‡/Æˆ}
        string=${string//Æ‰/É–}
        string=${string//ÆŠ/É—}
        string=${string//Æ‹/ÆŒ}
        string=${string//Æ/Ç}
        string=${string//Æ/É™}
        string=${string//Æ/É›}
        string=${string//Æ‘/Æ’}
        string=${string//Æ“/É }
        string=${string//Æ”/É£}
        string=${string//Æ–/É©}
        string=${string//Æ—/É¨}
        string=${string//Æ˜/Æ™}
        string=${string//Æœ/É¯}
        string=${string//Æ/É²}
        string=${string//ÆŸ/Éµ}
        string=${string//Æ /Æ¡}
        string=${string//Æ¢/Æ£}
        string=${string//Æ¤/Æ¥}
        string=${string//Æ¦/Ê€}
        string=${string//Æ§/Æ¨}
        string=${string//Æ©/Êƒ}
        string=${string//Æ¬/Æ­}
        string=${string//Æ®/Êˆ}
        string=${string//Æ¯/Æ°}
        string=${string//Æ±/ÊŠ}
        string=${string//Æ²/Ê‹}
        string=${string//Æ³/Æ´}
        string=${string//Æµ/Æ¶}
        string=${string//Æ·/Ê’}
        string=${string//Æ¸/Æ¹}
        string=${string//Æ¼/Æ½}
        string=${string//Ç„/Ç†}
        string=${string//Ç…/Ç†}
        string=${string//Ç‡/Ç‰}
        string=${string//Çˆ/Ç‰}
        string=${string//ÇŠ/ÇŒ}
        string=${string//Ç‹/ÇŒ}
        string=${string//Ç/Ç}
        string=${string//Ç/Ç}
        string=${string//Ç‘/Ç’}
        string=${string//Ç“/Ç”}
        string=${string//Ç•/Ç–}
        string=${string//Ç—/Ç˜}
        string=${string//Ç™/Çš}
        string=${string//Ç›/Çœ}
        string=${string//Ç/ÇŸ}
        string=${string//Ç /Ç¡}
        string=${string//Ç¢/Ç£}
        string=${string//Ç¤/Ç¥}
        string=${string//Ç¦/Ç§}
        string=${string//Ç¨/Ç©}
        string=${string//Çª/Ç«}
        string=${string//Ç¬/Ç­}
        string=${string//Ç®/Ç¯}
        string=${string//Ç±/Ç³}
        string=${string//Ç²/Ç³}
        string=${string//Ç´/Çµ}
        string=${string//Ç¶/Æ•}
        string=${string//Ç·/Æ¿}
        string=${string//Ç¸/Ç¹}
        string=${string//Çº/Ç»}
        string=${string//Ç¼/Ç½}
        string=${string//Ç¾/Ç¿}
        string=${string//È€/È}
        string=${string//È‚/Èƒ}
        string=${string//È„/È…}
        string=${string//È†/È‡}
        string=${string//Èˆ/È‰}
        string=${string//ÈŠ/È‹}
        string=${string//ÈŒ/È}
        string=${string//È/È}
        string=${string//È/È‘}
        string=${string//È’/È“}
        string=${string//È”/È•}
        string=${string//È–/È—}
        string=${string//È˜/È™}
        string=${string//Èš/È›}
        string=${string//Èœ/È}
        string=${string//È/ÈŸ}
        string=${string//È /Æ}
        string=${string//È¢/È£}
        string=${string//È¤/È¥}
        string=${string//È¦/È§}
        string=${string//È¨/È©}
        string=${string//Èª/È«}
        string=${string//È¬/È­}
        string=${string//È®/È¯}
        string=${string//È°/È±}
        string=${string//È²/È³}
        string=${string//Èº/â±¥}
        string=${string//È»/È¼}
        string=${string//È½/Æš}
        string=${string//È¾/â±¦}
        string=${string//É/É‚}
        string=${string//Éƒ/Æ€}
        string=${string//É„/Ê‰}
        string=${string//É…/ÊŒ}
        string=${string//É†/É‡}
        string=${string//Éˆ/É‰}
        string=${string//ÉŠ/É‹}
        string=${string//ÉŒ/É}
        string=${string//É/É}
        string=${string//Í°/Í±}
        string=${string//Í²/Í³}
        string=${string//Í¶/Í·}
        string=${string//Í¿/Ï³}
        string=${string//Î†/Î¬}
        string=${string//Îˆ/Î­}
        string=${string//Î‰/Î®}
        string=${string//ÎŠ/Î¯}
        string=${string//ÎŒ/ÏŒ}
        string=${string//Î/Ï}
        string=${string//Î/Ï}
        string=${string//Î‘/Î±}
        string=${string//Î’/Î²}
        string=${string//Î“/Î³}
        string=${string//Î”/Î´}
        string=${string//Î•/Îµ}
        string=${string//Î–/Î¶}
        string=${string//Î—/Î·}
        string=${string//Î˜/Î¸}
        string=${string//Î™/Î¹}
        string=${string//Îš/Îº}
        string=${string//Î›/Î»}
        string=${string//Îœ/Î¼}
        string=${string//Î/Î½}
        string=${string//Î/Î¾}
        string=${string//ÎŸ/Î¿}
        string=${string//Î /Ï€}
        string=${string//Î¡/Ï}
        string=${string//Î£/Ïƒ}
        string=${string//Î¤/Ï„}
        string=${string//Î¥/Ï…}
        string=${string//Î¦/Ï†}
        string=${string//Î§/Ï‡}
        string=${string//Î¨/Ïˆ}
        string=${string//Î©/Ï‰}
        string=${string//Îª/ÏŠ}
        string=${string//Î«/Ï‹}
        string=${string//Ï/Ï—}
        string=${string//Ï˜/Ï™}
        string=${string//Ïš/Ï›}
        string=${string//Ïœ/Ï}
        string=${string//Ï/ÏŸ}
        string=${string//Ï /Ï¡}
        string=${string//Ï¢/Ï£}
        string=${string//Ï¤/Ï¥}
        string=${string//Ï¦/Ï§}
        string=${string//Ï¨/Ï©}
        string=${string//Ïª/Ï«}
        string=${string//Ï¬/Ï­}
        string=${string//Ï®/Ï¯}
        string=${string//Ï´/Î¸}
        string=${string//Ï·/Ï¸}
        string=${string//Ï¹/Ï²}
        string=${string//Ïº/Ï»}
        string=${string//Ï½/Í»}
        string=${string//Ï¾/Í¼}
        string=${string//Ï¿/Í½}
        string=${string//Ğ€/Ñ}
        string=${string//Ğ/Ñ‘}
        string=${string//Ğ‚/Ñ’}
        string=${string//Ğƒ/Ñ“}
        string=${string//Ğ„/Ñ”}
        string=${string//Ğ…/Ñ•}
        string=${string//Ğ†/Ñ–}
        string=${string//Ğ‡/Ñ—}
        string=${string//Ğˆ/Ñ˜}
        string=${string//Ğ‰/Ñ™}
        string=${string//ĞŠ/Ñš}
        string=${string//Ğ‹/Ñ›}
        string=${string//ĞŒ/Ñœ}
        string=${string//Ğ/Ñ}
        string=${string//Ğ/Ñ}
        string=${string//Ğ/ÑŸ}
        string=${string//Ğ/Ğ°}
        string=${string//Ğ‘/Ğ±}
        string=${string//Ğ’/Ğ²}
        string=${string//Ğ“/Ğ³}
        string=${string//Ğ”/Ğ´}
        string=${string//Ğ•/Ğµ}
        string=${string//Ğ–/Ğ¶}
        string=${string//Ğ—/Ğ·}
        string=${string//Ğ˜/Ğ¸}
        string=${string//Ğ™/Ğ¹}
        string=${string//Ğš/Ğº}
        string=${string//Ğ›/Ğ»}
        string=${string//Ğœ/Ğ¼}
        string=${string//Ğ/Ğ½}
        string=${string//Ğ/Ğ¾}
        string=${string//ĞŸ/Ğ¿}
        string=${string//Ğ /Ñ€}
        string=${string//Ğ¡/Ñ}
        string=${string//Ğ¢/Ñ‚}
        string=${string//Ğ£/Ñƒ}
        string=${string//Ğ¤/Ñ„}
        string=${string//Ğ¥/Ñ…}
        string=${string//Ğ¦/Ñ†}
        string=${string//Ğ§/Ñ‡}
        string=${string//Ğ¨/Ñˆ}
        string=${string//Ğ©/Ñ‰}
        string=${string//Ğª/ÑŠ}
        string=${string//Ğ«/Ñ‹}
        string=${string//Ğ¬/ÑŒ}
        string=${string//Ğ­/Ñ}
        string=${string//Ğ®/Ñ}
        string=${string//Ğ¯/Ñ}
        string=${string//Ñ /Ñ¡}
        string=${string//Ñ¢/Ñ£}
        string=${string//Ñ¤/Ñ¥}
        string=${string//Ñ¦/Ñ§}
        string=${string//Ñ¨/Ñ©}
        string=${string//Ñª/Ñ«}
        string=${string//Ñ¬/Ñ­}
        string=${string//Ñ®/Ñ¯}
        string=${string//Ñ°/Ñ±}
        string=${string//Ñ²/Ñ³}
        string=${string//Ñ´/Ñµ}
        string=${string//Ñ¶/Ñ·}
        string=${string//Ñ¸/Ñ¹}
        string=${string//Ñº/Ñ»}
        string=${string//Ñ¼/Ñ½}
        string=${string//Ñ¾/Ñ¿}
        string=${string//Ò€/Ò}
        string=${string//ÒŠ/Ò‹}
        string=${string//ÒŒ/Ò}
        string=${string//Ò/Ò}
        string=${string//Ò/Ò‘}
        string=${string//Ò’/Ò“}
        string=${string//Ò”/Ò•}
        string=${string//Ò–/Ò—}
        string=${string//Ò˜/Ò™}
        string=${string//Òš/Ò›}
        string=${string//Òœ/Ò}
        string=${string//Ò/ÒŸ}
        string=${string//Ò /Ò¡}
        string=${string//Ò¢/Ò£}
        string=${string//Ò¤/Ò¥}
        string=${string//Ò¦/Ò§}
        string=${string//Ò¨/Ò©}
        string=${string//Òª/Ò«}
        string=${string//Ò¬/Ò­}
        string=${string//Ò®/Ò¯}
        string=${string//Ò°/Ò±}
        string=${string//Ò²/Ò³}
        string=${string//Ò´/Òµ}
        string=${string//Ò¶/Ò·}
        string=${string//Ò¸/Ò¹}
        string=${string//Òº/Ò»}
        string=${string//Ò¼/Ò½}
        string=${string//Ò¾/Ò¿}
        string=${string//Ó€/Ó}
        string=${string//Ó/Ó‚}
        string=${string//Óƒ/Ó„}
        string=${string//Ó…/Ó†}
        string=${string//Ó‡/Óˆ}
        string=${string//Ó‰/ÓŠ}
        string=${string//Ó‹/ÓŒ}
        string=${string//Ó/Ó}
        string=${string//Ó/Ó‘}
        string=${string//Ó’/Ó“}
        string=${string//Ó”/Ó•}
        string=${string//Ó–/Ó—}
        string=${string//Ó˜/Ó™}
        string=${string//Óš/Ó›}
        string=${string//Óœ/Ó}
        string=${string//Ó/ÓŸ}
        string=${string//Ó /Ó¡}
        string=${string//Ó¢/Ó£}
        string=${string//Ó¤/Ó¥}
        string=${string//Ó¦/Ó§}
        string=${string//Ó¨/Ó©}
        string=${string//Óª/Ó«}
        string=${string//Ó¬/Ó­}
        string=${string//Ó®/Ó¯}
        string=${string//Ó°/Ó±}
        string=${string//Ó²/Ó³}
        string=${string//Ó´/Óµ}
        string=${string//Ó¶/Ó·}
        string=${string//Ó¸/Ó¹}
        string=${string//Óº/Ó»}
        string=${string//Ó¼/Ó½}
        string=${string//Ó¾/Ó¿}
        string=${string//Ô€/Ô}
        string=${string//Ô‚/Ôƒ}
        string=${string//Ô„/Ô…}
        string=${string//Ô†/Ô‡}
        string=${string//Ôˆ/Ô‰}
        string=${string//ÔŠ/Ô‹}
        string=${string//ÔŒ/Ô}
        string=${string//Ô/Ô}
        string=${string//Ô/Ô‘}
        string=${string//Ô’/Ô“}
        string=${string//Ô”/Ô•}
        string=${string//Ô–/Ô—}
        string=${string//Ô˜/Ô™}
        string=${string//Ôš/Ô›}
        string=${string//Ôœ/Ô}
        string=${string//Ô/ÔŸ}
        string=${string//Ô /Ô¡}
        string=${string//Ô¢/Ô£}
        string=${string//Ô¤/Ô¥}
        string=${string//Ô¦/Ô§}
        string=${string//Ô¨/Ô©}
        string=${string//Ôª/Ô«}
        string=${string//Ô¬/Ô­}
        string=${string//Ô®/Ô¯}
        string=${string//Ô±/Õ¡}
        string=${string//Ô²/Õ¢}
        string=${string//Ô³/Õ£}
        string=${string//Ô´/Õ¤}
        string=${string//Ôµ/Õ¥}
        string=${string//Ô¶/Õ¦}
        string=${string//Ô·/Õ§}
        string=${string//Ô¸/Õ¨}
        string=${string//Ô¹/Õ©}
        string=${string//Ôº/Õª}
        string=${string//Ô»/Õ«}
        string=${string//Ô¼/Õ¬}
        string=${string//Ô½/Õ­}
        string=${string//Ô¾/Õ®}
        string=${string//Ô¿/Õ¯}
        string=${string//Õ€/Õ°}
        string=${string//Õ/Õ±}
        string=${string//Õ‚/Õ²}
        string=${string//Õƒ/Õ³}
        string=${string//Õ„/Õ´}
        string=${string//Õ…/Õµ}
        string=${string//Õ†/Õ¶}
        string=${string//Õ‡/Õ·}
        string=${string//Õˆ/Õ¸}
        string=${string//Õ‰/Õ¹}
        string=${string//ÕŠ/Õº}
        string=${string//Õ‹/Õ»}
        string=${string//ÕŒ/Õ¼}
        string=${string//Õ/Õ½}
        string=${string//Õ/Õ¾}
        string=${string//Õ/Õ¿}
        string=${string//Õ/Ö€}
        string=${string//Õ‘/Ö}
        string=${string//Õ’/Ö‚}
        string=${string//Õ“/Öƒ}
        string=${string//Õ”/Ö„}
        string=${string//Õ•/Ö…}
        string=${string//Õ–/Ö†}
        string=${string//á‚ /â´€}
        string=${string//á‚¡/â´}
        string=${string//á‚¢/â´‚}
        string=${string//á‚£/â´ƒ}
        string=${string//á‚¤/â´„}
        string=${string//á‚¥/â´…}
        string=${string//á‚¦/â´†}
        string=${string//á‚§/â´‡}
        string=${string//á‚¨/â´ˆ}
        string=${string//á‚©/â´‰}
        string=${string//á‚ª/â´Š}
        string=${string//á‚«/â´‹}
        string=${string//á‚¬/â´Œ}
        string=${string//á‚­/â´}
        string=${string//á‚®/â´}
        string=${string//á‚¯/â´}
        string=${string//á‚°/â´}
        string=${string//á‚±/â´‘}
        string=${string//á‚²/â´’}
        string=${string//á‚³/â´“}
        string=${string//á‚´/â´”}
        string=${string//á‚µ/â´•}
        string=${string//á‚¶/â´–}
        string=${string//á‚·/â´—}
        string=${string//á‚¸/â´˜}
        string=${string//á‚¹/â´™}
        string=${string//á‚º/â´š}
        string=${string//á‚»/â´›}
        string=${string//á‚¼/â´œ}
        string=${string//á‚½/â´}
        string=${string//á‚¾/â´}
        string=${string//á‚¿/â´Ÿ}
        string=${string//áƒ€/â´ }
        string=${string//áƒ/â´¡}
        string=${string//áƒ‚/â´¢}
        string=${string//áƒƒ/â´£}
        string=${string//áƒ„/â´¤}
        string=${string//áƒ…/â´¥}
        string=${string//áƒ‡/â´§}
        string=${string//áƒ/â´­}
        string=${string//á /ê­°}
        string=${string//á¡/ê­±}
        string=${string//á¢/ê­²}
        string=${string//á£/ê­³}
        string=${string//á¤/ê­´}
        string=${string//á¥/ê­µ}
        string=${string//á¦/ê­¶}
        string=${string//á§/ê­·}
        string=${string//á¨/ê­¸}
        string=${string//á©/ê­¹}
        string=${string//áª/ê­º}
        string=${string//á«/ê­»}
        string=${string//á¬/ê­¼}
        string=${string//á­/ê­½}
        string=${string//á®/ê­¾}
        string=${string//á¯/ê­¿}
        string=${string//á°/ê®€}
        string=${string//á±/ê®}
        string=${string//á²/ê®‚}
        string=${string//á³/ê®ƒ}
        string=${string//á´/ê®„}
        string=${string//áµ/ê®…}
        string=${string//á¶/ê®†}
        string=${string//á·/ê®‡}
        string=${string//á¸/ê®ˆ}
        string=${string//á¹/ê®‰}
        string=${string//áº/ê®Š}
        string=${string//á»/ê®‹}
        string=${string//á¼/ê®Œ}
        string=${string//á½/ê®}
        string=${string//á¾/ê®}
        string=${string//á¿/ê®}
        string=${string//á€/ê®}
        string=${string//á/ê®‘}
        string=${string//á‚/ê®’}
        string=${string//áƒ/ê®“}
        string=${string//á„/ê®”}
        string=${string//á…/ê®•}
        string=${string//á†/ê®–}
        string=${string//á‡/ê®—}
        string=${string//áˆ/ê®˜}
        string=${string//á‰/ê®™}
        string=${string//áŠ/ê®š}
        string=${string//á‹/ê®›}
        string=${string//áŒ/ê®œ}
        string=${string//á/ê®}
        string=${string//á/ê®}
        string=${string//á/ê®Ÿ}
        string=${string//á/ê® }
        string=${string//á‘/ê®¡}
        string=${string//á’/ê®¢}
        string=${string//á“/ê®£}
        string=${string//á”/ê®¤}
        string=${string//á•/ê®¥}
        string=${string//á–/ê®¦}
        string=${string//á—/ê®§}
        string=${string//á˜/ê®¨}
        string=${string//á™/ê®©}
        string=${string//áš/ê®ª}
        string=${string//á›/ê®«}
        string=${string//áœ/ê®¬}
        string=${string//á/ê®­}
        string=${string//á/ê®®}
        string=${string//áŸ/ê®¯}
        string=${string//á /ê®°}
        string=${string//á¡/ê®±}
        string=${string//á¢/ê®²}
        string=${string//á£/ê®³}
        string=${string//á¤/ê®´}
        string=${string//á¥/ê®µ}
        string=${string//á¦/ê®¶}
        string=${string//á§/ê®·}
        string=${string//á¨/ê®¸}
        string=${string//á©/ê®¹}
        string=${string//áª/ê®º}
        string=${string//á«/ê®»}
        string=${string//á¬/ê®¼}
        string=${string//á­/ê®½}
        string=${string//á®/ê®¾}
        string=${string//á¯/ê®¿}
        string=${string//á°/á¸}
        string=${string//á±/á¹}
        string=${string//á²/áº}
        string=${string//á³/á»}
        string=${string//á´/á¼}
        string=${string//áµ/á½}
        string=${string//á¸€/á¸}
        string=${string//á¸‚/á¸ƒ}
        string=${string//á¸„/á¸…}
        string=${string//á¸†/á¸‡}
        string=${string//á¸ˆ/á¸‰}
        string=${string//á¸Š/á¸‹}
        string=${string//á¸Œ/á¸}
        string=${string//á¸/á¸}
        string=${string//á¸/á¸‘}
        string=${string//á¸’/á¸“}
        string=${string//á¸”/á¸•}
        string=${string//á¸–/á¸—}
        string=${string//á¸˜/á¸™}
        string=${string//á¸š/á¸›}
        string=${string//á¸œ/á¸}
        string=${string//á¸/á¸Ÿ}
        string=${string//á¸ /á¸¡}
        string=${string//á¸¢/á¸£}
        string=${string//á¸¤/á¸¥}
        string=${string//á¸¦/á¸§}
        string=${string//á¸¨/á¸©}
        string=${string//á¸ª/á¸«}
        string=${string//á¸¬/á¸­}
        string=${string//á¸®/á¸¯}
        string=${string//á¸°/á¸±}
        string=${string//á¸²/á¸³}
        string=${string//á¸´/á¸µ}
        string=${string//á¸¶/á¸·}
        string=${string//á¸¸/á¸¹}
        string=${string//á¸º/á¸»}
        string=${string//á¸¼/á¸½}
        string=${string//á¸¾/á¸¿}
        string=${string//á¹€/á¹}
        string=${string//á¹‚/á¹ƒ}
        string=${string//á¹„/á¹…}
        string=${string//á¹†/á¹‡}
        string=${string//á¹ˆ/á¹‰}
        string=${string//á¹Š/á¹‹}
        string=${string//á¹Œ/á¹}
        string=${string//á¹/á¹}
        string=${string//á¹/á¹‘}
        string=${string//á¹’/á¹“}
        string=${string//á¹”/á¹•}
        string=${string//á¹–/á¹—}
        string=${string//á¹˜/á¹™}
        string=${string//á¹š/á¹›}
        string=${string//á¹œ/á¹}
        string=${string//á¹/á¹Ÿ}
        string=${string//á¹ /á¹¡}
        string=${string//á¹¢/á¹£}
        string=${string//á¹¤/á¹¥}
        string=${string//á¹¦/á¹§}
        string=${string//á¹¨/á¹©}
        string=${string//á¹ª/á¹«}
        string=${string//á¹¬/á¹­}
        string=${string//á¹®/á¹¯}
        string=${string//á¹°/á¹±}
        string=${string//á¹²/á¹³}
        string=${string//á¹´/á¹µ}
        string=${string//á¹¶/á¹·}
        string=${string//á¹¸/á¹¹}
        string=${string//á¹º/á¹»}
        string=${string//á¹¼/á¹½}
        string=${string//á¹¾/á¹¿}
        string=${string//áº€/áº}
        string=${string//áº‚/áºƒ}
        string=${string//áº„/áº…}
        string=${string//áº†/áº‡}
        string=${string//áºˆ/áº‰}
        string=${string//áºŠ/áº‹}
        string=${string//áºŒ/áº}
        string=${string//áº/áº}
        string=${string//áº/áº‘}
        string=${string//áº’/áº“}
        string=${string//áº”/áº•}
        string=${string//áº/ÃŸ}
        string=${string//áº /áº¡}
        string=${string//áº¢/áº£}
        string=${string//áº¤/áº¥}
        string=${string//áº¦/áº§}
        string=${string//áº¨/áº©}
        string=${string//áºª/áº«}
        string=${string//áº¬/áº­}
        string=${string//áº®/áº¯}
        string=${string//áº°/áº±}
        string=${string//áº²/áº³}
        string=${string//áº´/áºµ}
        string=${string//áº¶/áº·}
        string=${string//áº¸/áº¹}
        string=${string//áºº/áº»}
        string=${string//áº¼/áº½}
        string=${string//áº¾/áº¿}
        string=${string//á»€/á»}
        string=${string//á»‚/á»ƒ}
        string=${string//á»„/á»…}
        string=${string//á»†/á»‡}
        string=${string//á»ˆ/á»‰}
        string=${string//á»Š/á»‹}
        string=${string//á»Œ/á»}
        string=${string//á»/á»}
        string=${string//á»/á»‘}
        string=${string//á»’/á»“}
        string=${string//á»”/á»•}
        string=${string//á»–/á»—}
        string=${string//á»˜/á»™}
        string=${string//á»š/á»›}
        string=${string//á»œ/á»}
        string=${string//á»/á»Ÿ}
        string=${string//á» /á»¡}
        string=${string//á»¢/á»£}
        string=${string//á»¤/á»¥}
        string=${string//á»¦/á»§}
        string=${string//á»¨/á»©}
        string=${string//á»ª/á»«}
        string=${string//á»¬/á»­}
        string=${string//á»®/á»¯}
        string=${string//á»°/á»±}
        string=${string//á»²/á»³}
        string=${string//á»´/á»µ}
        string=${string//á»¶/á»·}
        string=${string//á»¸/á»¹}
        string=${string//á»º/á»»}
        string=${string//á»¼/á»½}
        string=${string//á»¾/á»¿}
        string=${string//á¼ˆ/á¼€}
        string=${string//á¼‰/á¼}
        string=${string//á¼Š/á¼‚}
        string=${string//á¼‹/á¼ƒ}
        string=${string//á¼Œ/á¼„}
        string=${string//á¼/á¼…}
        string=${string//á¼/á¼†}
        string=${string//á¼/á¼‡}
        string=${string//á¼˜/á¼}
        string=${string//á¼™/á¼‘}
        string=${string//á¼š/á¼’}
        string=${string//á¼›/á¼“}
        string=${string//á¼œ/á¼”}
        string=${string//á¼/á¼•}
        string=${string//á¼¨/á¼ }
        string=${string//á¼©/á¼¡}
        string=${string//á¼ª/á¼¢}
        string=${string//á¼«/á¼£}
        string=${string//á¼¬/á¼¤}
        string=${string//á¼­/á¼¥}
        string=${string//á¼®/á¼¦}
        string=${string//á¼¯/á¼§}
        string=${string//á¼¸/á¼°}
        string=${string//á¼¹/á¼±}
        string=${string//á¼º/á¼²}
        string=${string//á¼»/á¼³}
        string=${string//á¼¼/á¼´}
        string=${string//á¼½/á¼µ}
        string=${string//á¼¾/á¼¶}
        string=${string//á¼¿/á¼·}
        string=${string//á½ˆ/á½€}
        string=${string//á½‰/á½}
        string=${string//á½Š/á½‚}
        string=${string//á½‹/á½ƒ}
        string=${string//á½Œ/á½„}
        string=${string//á½/á½…}
        string=${string//á½™/á½‘}
        string=${string//á½›/á½“}
        string=${string//á½/á½•}
        string=${string//á½Ÿ/á½—}
        string=${string//á½¨/á½ }
        string=${string//á½©/á½¡}
        string=${string//á½ª/á½¢}
        string=${string//á½«/á½£}
        string=${string//á½¬/á½¤}
        string=${string//á½­/á½¥}
        string=${string//á½®/á½¦}
        string=${string//á½¯/á½§}
        string=${string//á¾ˆ/á¾€}
        string=${string//á¾‰/á¾}
        string=${string//á¾Š/á¾‚}
        string=${string//á¾‹/á¾ƒ}
        string=${string//á¾Œ/á¾„}
        string=${string//á¾/á¾…}
        string=${string//á¾/á¾†}
        string=${string//á¾/á¾‡}
        string=${string//á¾˜/á¾}
        string=${string//á¾™/á¾‘}
        string=${string//á¾š/á¾’}
        string=${string//á¾›/á¾“}
        string=${string//á¾œ/á¾”}
        string=${string//á¾/á¾•}
        string=${string//á¾/á¾–}
        string=${string//á¾Ÿ/á¾—}
        string=${string//á¾¨/á¾ }
        string=${string//á¾©/á¾¡}
        string=${string//á¾ª/á¾¢}
        string=${string//á¾«/á¾£}
        string=${string//á¾¬/á¾¤}
        string=${string//á¾­/á¾¥}
        string=${string//á¾®/á¾¦}
        string=${string//á¾¯/á¾§}
        string=${string//á¾¸/á¾°}
        string=${string//á¾¹/á¾±}
        string=${string//á¾º/á½°}
        string=${string//á¾»/á½±}
        string=${string//á¾¼/á¾³}
        string=${string//á¿ˆ/á½²}
        string=${string//á¿‰/á½³}
        string=${string//á¿Š/á½´}
        string=${string//á¿‹/á½µ}
        string=${string//á¿Œ/á¿ƒ}
        string=${string//á¿˜/á¿}
        string=${string//á¿™/á¿‘}
        string=${string//á¿š/á½¶}
        string=${string//á¿›/á½·}
        string=${string//á¿¨/á¿ }
        string=${string//á¿©/á¿¡}
        string=${string//á¿ª/á½º}
        string=${string//á¿«/á½»}
        string=${string//á¿¬/á¿¥}
        string=${string//á¿¸/á½¸}
        string=${string//á¿¹/á½¹}
        string=${string//á¿º/á½¼}
        string=${string//á¿»/á½½}
        string=${string//á¿¼/á¿³}
        string=${string//â„¦/Ï‰}
        string=${string//â„ª/k}
        string=${string//â„«/Ã¥}
        string=${string//â„²/â…}
        string=${string//â… /â…°}
        string=${string//â…¡/â…±}
        string=${string//â…¢/â…²}
        string=${string//â…£/â…³}
        string=${string//â…¤/â…´}
        string=${string//â…¥/â…µ}
        string=${string//â…¦/â…¶}
        string=${string//â…§/â…·}
        string=${string//â…¨/â…¸}
        string=${string//â…©/â…¹}
        string=${string//â…ª/â…º}
        string=${string//â…«/â…»}
        string=${string//â…¬/â…¼}
        string=${string//â…­/â…½}
        string=${string//â…®/â…¾}
        string=${string//â…¯/â…¿}
        string=${string//â†ƒ/â†„}
        string=${string//â’¶/â“}
        string=${string//â’·/â“‘}
        string=${string//â’¸/â“’}
        string=${string//â’¹/â““}
        string=${string//â’º/â“”}
        string=${string//â’»/â“•}
        string=${string//â’¼/â“–}
        string=${string//â’½/â“—}
        string=${string//â’¾/â“˜}
        string=${string//â’¿/â“™}
        string=${string//â“€/â“š}
        string=${string//â“/â“›}
        string=${string//â“‚/â“œ}
        string=${string//â“ƒ/â“}
        string=${string//â“„/â“}
        string=${string//â“…/â“Ÿ}
        string=${string//â“†/â“ }
        string=${string//â“‡/â“¡}
        string=${string//â“ˆ/â“¢}
        string=${string//â“‰/â“£}
        string=${string//â“Š/â“¤}
        string=${string//â“‹/â“¥}
        string=${string//â“Œ/â“¦}
        string=${string//â“/â“§}
        string=${string//â“/â“¨}
        string=${string//â“/â“©}
        string=${string//â°€/â°°}
        string=${string//â°/â°±}
        string=${string//â°‚/â°²}
        string=${string//â°ƒ/â°³}
        string=${string//â°„/â°´}
        string=${string//â°…/â°µ}
        string=${string//â°†/â°¶}
        string=${string//â°‡/â°·}
        string=${string//â°ˆ/â°¸}
        string=${string//â°‰/â°¹}
        string=${string//â°Š/â°º}
        string=${string//â°‹/â°»}
        string=${string//â°Œ/â°¼}
        string=${string//â°/â°½}
        string=${string//â°/â°¾}
        string=${string//â°/â°¿}
        string=${string//â°/â±€}
        string=${string//â°‘/â±}
        string=${string//â°’/â±‚}
        string=${string//â°“/â±ƒ}
        string=${string//â°”/â±„}
        string=${string//â°•/â±…}
        string=${string//â°–/â±†}
        string=${string//â°—/â±‡}
        string=${string//â°˜/â±ˆ}
        string=${string//â°™/â±‰}
        string=${string//â°š/â±Š}
        string=${string//â°›/â±‹}
        string=${string//â°œ/â±Œ}
        string=${string//â°/â±}
        string=${string//â°/â±}
        string=${string//â°Ÿ/â±}
        string=${string//â° /â±}
        string=${string//â°¡/â±‘}
        string=${string//â°¢/â±’}
        string=${string//â°£/â±“}
        string=${string//â°¤/â±”}
        string=${string//â°¥/â±•}
        string=${string//â°¦/â±–}
        string=${string//â°§/â±—}
        string=${string//â°¨/â±˜}
        string=${string//â°©/â±™}
        string=${string//â°ª/â±š}
        string=${string//â°«/â±›}
        string=${string//â°¬/â±œ}
        string=${string//â°­/â±}
        string=${string//â°®/â±}
        string=${string//â± /â±¡}
        string=${string//â±¢/É«}
        string=${string//â±£/áµ½}
        string=${string//â±¤/É½}
        string=${string//â±§/â±¨}
        string=${string//â±©/â±ª}
        string=${string//â±«/â±¬}
        string=${string//â±­/É‘}
        string=${string//â±®/É±}
        string=${string//â±¯/É}
        string=${string//â±°/É’}
        string=${string//â±²/â±³}
        string=${string//â±µ/â±¶}
        string=${string//â±¾/È¿}
        string=${string//â±¿/É€}
        string=${string//â²€/â²}
        string=${string//â²‚/â²ƒ}
        string=${string//â²„/â²…}
        string=${string//â²†/â²‡}
        string=${string//â²ˆ/â²‰}
        string=${string//â²Š/â²‹}
        string=${string//â²Œ/â²}
        string=${string//â²/â²}
        string=${string//â²/â²‘}
        string=${string//â²’/â²“}
        string=${string//â²”/â²•}
        string=${string//â²–/â²—}
        string=${string//â²˜/â²™}
        string=${string//â²š/â²›}
        string=${string//â²œ/â²}
        string=${string//â²/â²Ÿ}
        string=${string//â² /â²¡}
        string=${string//â²¢/â²£}
        string=${string//â²¤/â²¥}
        string=${string//â²¦/â²§}
        string=${string//â²¨/â²©}
        string=${string//â²ª/â²«}
        string=${string//â²¬/â²­}
        string=${string//â²®/â²¯}
        string=${string//â²°/â²±}
        string=${string//â²²/â²³}
        string=${string//â²´/â²µ}
        string=${string//â²¶/â²·}
        string=${string//â²¸/â²¹}
        string=${string//â²º/â²»}
        string=${string//â²¼/â²½}
        string=${string//â²¾/â²¿}
        string=${string//â³€/â³}
        string=${string//â³‚/â³ƒ}
        string=${string//â³„/â³…}
        string=${string//â³†/â³‡}
        string=${string//â³ˆ/â³‰}
        string=${string//â³Š/â³‹}
        string=${string//â³Œ/â³}
        string=${string//â³/â³}
        string=${string//â³/â³‘}
        string=${string//â³’/â³“}
        string=${string//â³”/â³•}
        string=${string//â³–/â³—}
        string=${string//â³˜/â³™}
        string=${string//â³š/â³›}
        string=${string//â³œ/â³}
        string=${string//â³/â³Ÿ}
        string=${string//â³ /â³¡}
        string=${string//â³¢/â³£}
        string=${string//â³«/â³¬}
        string=${string//â³­/â³®}
        string=${string//â³²/â³³}
        string=${string//ê™€/ê™}
        string=${string//ê™‚/ê™ƒ}
        string=${string//ê™„/ê™…}
        string=${string//ê™†/ê™‡}
        string=${string//ê™ˆ/ê™‰}
        string=${string//ê™Š/ê™‹}
        string=${string//ê™Œ/ê™}
        string=${string//ê™/ê™}
        string=${string//ê™/ê™‘}
        string=${string//ê™’/ê™“}
        string=${string//ê™”/ê™•}
        string=${string//ê™–/ê™—}
        string=${string//ê™˜/ê™™}
        string=${string//ê™š/ê™›}
        string=${string//ê™œ/ê™}
        string=${string//ê™/ê™Ÿ}
        string=${string//ê™ /ê™¡}
        string=${string//ê™¢/ê™£}
        string=${string//ê™¤/ê™¥}
        string=${string//ê™¦/ê™§}
        string=${string//ê™¨/ê™©}
        string=${string//ê™ª/ê™«}
        string=${string//ê™¬/ê™­}
        string=${string//êš€/êš}
        string=${string//êš‚/êšƒ}
        string=${string//êš„/êš…}
        string=${string//êš†/êš‡}
        string=${string//êšˆ/êš‰}
        string=${string//êšŠ/êš‹}
        string=${string//êšŒ/êš}
        string=${string//êš/êš}
        string=${string//êš/êš‘}
        string=${string//êš’/êš“}
        string=${string//êš”/êš•}
        string=${string//êš–/êš—}
        string=${string//êš˜/êš™}
        string=${string//êšš/êš›}
        string=${string//êœ¢/êœ£}
        string=${string//êœ¤/êœ¥}
        string=${string//êœ¦/êœ§}
        string=${string//êœ¨/êœ©}
        string=${string//êœª/êœ«}
        string=${string//êœ¬/êœ­}
        string=${string//êœ®/êœ¯}
        string=${string//êœ²/êœ³}
        string=${string//êœ´/êœµ}
        string=${string//êœ¶/êœ·}
        string=${string//êœ¸/êœ¹}
        string=${string//êœº/êœ»}
        string=${string//êœ¼/êœ½}
        string=${string//êœ¾/êœ¿}
        string=${string//ê€/ê}
        string=${string//ê‚/êƒ}
        string=${string//ê„/ê…}
        string=${string//ê†/ê‡}
        string=${string//êˆ/ê‰}
        string=${string//êŠ/ê‹}
        string=${string//êŒ/ê}
        string=${string//ê/ê}
        string=${string//ê/ê‘}
        string=${string//ê’/ê“}
        string=${string//ê”/ê•}
        string=${string//ê–/ê—}
        string=${string//ê˜/ê™}
        string=${string//êš/ê›}
        string=${string//êœ/ê}
        string=${string//ê/êŸ}
        string=${string//ê /ê¡}
        string=${string//ê¢/ê£}
        string=${string//ê¤/ê¥}
        string=${string//ê¦/ê§}
        string=${string//ê¨/ê©}
        string=${string//êª/ê«}
        string=${string//ê¬/ê­}
        string=${string//ê®/ê¯}
        string=${string//ê¹/êº}
        string=${string//ê»/ê¼}
        string=${string//ê½/áµ¹}
        string=${string//ê¾/ê¿}
        string=${string//ê€/ê}
        string=${string//ê‚/êƒ}
        string=${string//ê„/ê…}
        string=${string//ê†/ê‡}
        string=${string//ê‹/êŒ}
        string=${string//ê/É¥}
        string=${string//ê/ê‘}
        string=${string//ê’/ê“}
        string=${string//ê–/ê—}
        string=${string//ê˜/ê™}
        string=${string//êš/ê›}
        string=${string//êœ/ê}
        string=${string//ê/êŸ}
        string=${string//ê /ê¡}
        string=${string//ê¢/ê£}
        string=${string//ê¤/ê¥}
        string=${string//ê¦/ê§}
        string=${string//ê¨/ê©}
        string=${string//êª/É¦}
        string=${string//ê«/Éœ}
        string=${string//ê¬/É¡}
        string=${string//ê­/É¬}
        string=${string//ê®/Éª}
        string=${string//ê°/Ê}
        string=${string//ê±/Ê‡}
        string=${string//ê²/Ê}
        string=${string//ê³/ê­“}
        string=${string//ê´/êµ}
        string=${string//ê¶/ê·}
        string=${string//ï¼¡/ï½}
        string=${string//ï¼¢/ï½‚}
        string=${string//ï¼£/ï½ƒ}
        string=${string//ï¼¤/ï½„}
        string=${string//ï¼¥/ï½…}
        string=${string//ï¼¦/ï½†}
        string=${string//ï¼§/ï½‡}
        string=${string//ï¼¨/ï½ˆ}
        string=${string//ï¼©/ï½‰}
        string=${string//ï¼ª/ï½Š}
        string=${string//ï¼«/ï½‹}
        string=${string//ï¼¬/ï½Œ}
        string=${string//ï¼­/ï½}
        string=${string//ï¼®/ï½}
        string=${string//ï¼¯/ï½}
        string=${string//ï¼°/ï½}
        string=${string//ï¼±/ï½‘}
        string=${string//ï¼²/ï½’}
        string=${string//ï¼³/ï½“}
        string=${string//ï¼´/ï½”}
        string=${string//ï¼µ/ï½•}
        string=${string//ï¼¶/ï½–}
        string=${string//ï¼·/ï½—}
        string=${string//ï¼¸/ï½˜}
        string=${string//ï¼¹/ï½™}
        string=${string//ï¼º/ï½š}
        string=${string//ğ€/ğ¨}
        string=${string//ğ/ğ©}
        string=${string//ğ‚/ğª}
        string=${string//ğƒ/ğ«}
        string=${string//ğ„/ğ¬}
        string=${string//ğ…/ğ­}
        string=${string//ğ†/ğ®}
        string=${string//ğ‡/ğ¯}
        string=${string//ğˆ/ğ°}
        string=${string//ğ‰/ğ±}
        string=${string//ğŠ/ğ²}
        string=${string//ğ‹/ğ³}
        string=${string//ğŒ/ğ´}
        string=${string//ğ/ğµ}
        string=${string//ğ/ğ¶}
        string=${string//ğ/ğ·}
        string=${string//ğ/ğ¸}
        string=${string//ğ‘/ğ¹}
        string=${string//ğ’/ğº}
        string=${string//ğ“/ğ»}
        string=${string//ğ”/ğ¼}
        string=${string//ğ•/ğ½}
        string=${string//ğ–/ğ¾}
        string=${string//ğ—/ğ¿}
        string=${string//ğ˜/ğ‘€}
        string=${string//ğ™/ğ‘}
        string=${string//ğš/ğ‘‚}
        string=${string//ğ›/ğ‘ƒ}
        string=${string//ğœ/ğ‘„}
        string=${string//ğ/ğ‘…}
        string=${string//ğ/ğ‘†}
        string=${string//ğŸ/ğ‘‡}
        string=${string//ğ /ğ‘ˆ}
        string=${string//ğ¡/ğ‘‰}
        string=${string//ğ¢/ğ‘Š}
        string=${string//ğ£/ğ‘‹}
        string=${string//ğ¤/ğ‘Œ}
        string=${string//ğ¥/ğ‘}
        string=${string//ğ¦/ğ‘}
        string=${string//ğ§/ğ‘}
        string=${string//ğ’°/ğ“˜}
        string=${string//ğ’±/ğ“™}
        string=${string//ğ’²/ğ“š}
        string=${string//ğ’³/ğ“›}
        string=${string//ğ’´/ğ“œ}
        string=${string//ğ’µ/ğ“}
        string=${string//ğ’¶/ğ“}
        string=${string//ğ’·/ğ“Ÿ}
        string=${string//ğ’¸/ğ“ }
        string=${string//ğ’¹/ğ“¡}
        string=${string//ğ’º/ğ“¢}
        string=${string//ğ’»/ğ“£}
        string=${string//ğ’¼/ğ“¤}
        string=${string//ğ’½/ğ“¥}
        string=${string//ğ’¾/ğ“¦}
        string=${string//ğ’¿/ğ“§}
        string=${string//ğ“€/ğ“¨}
        string=${string//ğ“/ğ“©}
        string=${string//ğ“‚/ğ“ª}
        string=${string//ğ“ƒ/ğ“«}
        string=${string//ğ“„/ğ“¬}
        string=${string//ğ“…/ğ“­}
        string=${string//ğ“†/ğ“®}
        string=${string//ğ“‡/ğ“¯}
        string=${string//ğ“ˆ/ğ“°}
        string=${string//ğ“‰/ğ“±}
        string=${string//ğ“Š/ğ“²}
        string=${string//ğ“‹/ğ“³}
        string=${string//ğ“Œ/ğ“´}
        string=${string//ğ“/ğ“µ}
        string=${string//ğ“/ğ“¶}
        string=${string//ğ“/ğ“·}
        string=${string//ğ“/ğ“¸}
        string=${string//ğ“‘/ğ“¹}
        string=${string//ğ“’/ğ“º}
        string=${string//ğ““/ğ“»}
        string=${string//ğ²€/ğ³€}
        string=${string//ğ²/ğ³}
        string=${string//ğ²‚/ğ³‚}
        string=${string//ğ²ƒ/ğ³ƒ}
        string=${string//ğ²„/ğ³„}
        string=${string//ğ²…/ğ³…}
        string=${string//ğ²†/ğ³†}
        string=${string//ğ²‡/ğ³‡}
        string=${string//ğ²ˆ/ğ³ˆ}
        string=${string//ğ²‰/ğ³‰}
        string=${string//ğ²Š/ğ³Š}
        string=${string//ğ²‹/ğ³‹}
        string=${string//ğ²Œ/ğ³Œ}
        string=${string//ğ²/ğ³}
        string=${string//ğ²/ğ³}
        string=${string//ğ²/ğ³}
        string=${string//ğ²/ğ³}
        string=${string//ğ²‘/ğ³‘}
        string=${string//ğ²’/ğ³’}
        string=${string//ğ²“/ğ³“}
        string=${string//ğ²”/ğ³”}
        string=${string//ğ²•/ğ³•}
        string=${string//ğ²–/ğ³–}
        string=${string//ğ²—/ğ³—}
        string=${string//ğ²˜/ğ³˜}
        string=${string//ğ²™/ğ³™}
        string=${string//ğ²š/ğ³š}
        string=${string//ğ²›/ğ³›}
        string=${string//ğ²œ/ğ³œ}
        string=${string//ğ²/ğ³}
        string=${string//ğ²/ğ³}
        string=${string//ğ²Ÿ/ğ³Ÿ}
        string=${string//ğ² /ğ³ }
        string=${string//ğ²¡/ğ³¡}
        string=${string//ğ²¢/ğ³¢}
        string=${string//ğ²£/ğ³£}
        string=${string//ğ²¤/ğ³¤}
        string=${string//ğ²¥/ğ³¥}
        string=${string//ğ²¦/ğ³¦}
        string=${string//ğ²§/ğ³§}
        string=${string//ğ²¨/ğ³¨}
        string=${string//ğ²©/ğ³©}
        string=${string//ğ²ª/ğ³ª}
        string=${string//ğ²«/ğ³«}
        string=${string//ğ²¬/ğ³¬}
        string=${string//ğ²­/ğ³­}
        string=${string//ğ²®/ğ³®}
        string=${string//ğ²¯/ğ³¯}
        string=${string//ğ²°/ğ³°}
        string=${string//ğ²±/ğ³±}
        string=${string//ğ²²/ğ³²}
        string=${string//ğ‘¢ /ğ‘£€}
        string=${string//ğ‘¢¡/ğ‘£}
        string=${string//ğ‘¢¢/ğ‘£‚}
        string=${string//ğ‘¢£/ğ‘£ƒ}
        string=${string//ğ‘¢¤/ğ‘£„}
        string=${string//ğ‘¢¥/ğ‘£…}
        string=${string//ğ‘¢¦/ğ‘£†}
        string=${string//ğ‘¢§/ğ‘£‡}
        string=${string//ğ‘¢¨/ğ‘£ˆ}
        string=${string//ğ‘¢©/ğ‘£‰}
        string=${string//ğ‘¢ª/ğ‘£Š}
        string=${string//ğ‘¢«/ğ‘£‹}
        string=${string//ğ‘¢¬/ğ‘£Œ}
        string=${string//ğ‘¢­/ğ‘£}
        string=${string//ğ‘¢®/ğ‘£}
        string=${string//ğ‘¢¯/ğ‘£}
        string=${string//ğ‘¢°/ğ‘£}
        string=${string//ğ‘¢±/ğ‘£‘}
        string=${string//ğ‘¢²/ğ‘£’}
        string=${string//ğ‘¢³/ğ‘£“}
        string=${string//ğ‘¢´/ğ‘£”}
        string=${string//ğ‘¢µ/ğ‘£•}
        string=${string//ğ‘¢¶/ğ‘£–}
        string=${string//ğ‘¢·/ğ‘£—}
        string=${string//ğ‘¢¸/ğ‘£˜}
        string=${string//ğ‘¢¹/ğ‘£™}
        string=${string//ğ‘¢º/ğ‘£š}
        string=${string//ğ‘¢»/ğ‘£›}
        string=${string//ğ‘¢¼/ğ‘£œ}
        string=${string//ğ‘¢½/ğ‘£}
        string=${string//ğ‘¢¾/ğ‘£}
        string=${string//ğ‘¢¿/ğ‘£Ÿ}
        string=${string//ğ¤€/ğ¤¢}
        string=${string//ğ¤/ğ¤£}
        string=${string//ğ¤‚/ğ¤¤}
        string=${string//ğ¤ƒ/ğ¤¥}
        string=${string//ğ¤„/ğ¤¦}
        string=${string//ğ¤…/ğ¤§}
        string=${string//ğ¤†/ğ¤¨}
        string=${string//ğ¤‡/ğ¤©}
        string=${string//ğ¤ˆ/ğ¤ª}
        string=${string//ğ¤‰/ğ¤«}
        string=${string//ğ¤Š/ğ¤¬}
        string=${string//ğ¤‹/ğ¤­}
        string=${string//ğ¤Œ/ğ¤®}
        string=${string//ğ¤/ğ¤¯}
        string=${string//ğ¤/ğ¤°}
        string=${string//ğ¤/ğ¤±}
        string=${string//ğ¤/ğ¤²}
        string=${string//ğ¤‘/ğ¤³}
        string=${string//ğ¤’/ğ¤´}
        string=${string//ğ¤“/ğ¤µ}
        string=${string//ğ¤”/ğ¤¶}
        string=${string//ğ¤•/ğ¤·}
        string=${string//ğ¤–/ğ¤¸}
        string=${string//ğ¤—/ğ¤¹}
        string=${string//ğ¤˜/ğ¤º}
        string=${string//ğ¤™/ğ¤»}
        string=${string//ğ¤š/ğ¤¼}
        string=${string//ğ¤›/ğ¤½}
        string=${string//ğ¤œ/ğ¤¾}
        string=${string//ğ¤/ğ¤¿}
        string=${string//ğ¤/ğ¥€}
        string=${string//ğ¤Ÿ/ğ¥}
        string=${string//ğ¤ /ğ¥‚}
        string=${string//ğ¤¡/ğ¥ƒ}
    fi

    local "${1-}" && assign::value "$1" "$string"
}

if [[ "${BASH_VERSINFO[0]}" -lt 4 ]] || [[ "${BASH_VERSINFO[0]}" -eq 4 && "${BASH_VERSINFO[1]}" -lt 2 ]]; then
    #: Use the fallback because the faster method is not available.
    string::toLower() {
        string::toLowerFallback "$1" "$2"
    }
fi


if [[ "${BASH_VERSINFO[0]}" -gt 4 ]] || [[ "${BASH_VERSINFO[0]}" -eq 4 && "${BASH_VERSINFO[1]}" -ge 2 ]]; then
    # Converts a string to uppercase. Not locale-aware.
    #
    # $1 - Destination variable name.
    # $2 - String to convert.
    #
    # Returns nothing.
    string::toUpper() {
        local "${1-}" && assign::value "$1" "${2^^}"
    }
fi


# Converts a string to uppercase. Not locale-aware, but does handle Unicode.
#
# $1 - Destination variable name.
# $2 - String to convert.
#
# Returns nothing.
string::toUpperFallback() {
    local string

    string=$2

    if [[ "$string" != *[^[:ascii:]]* ]]; then
        string=${string//a/A}
        string=${string//b/B}
        string=${string//c/C}
        string=${string//d/D}
        string=${string//e/E}
        string=${string//f/F}
        string=${string//g/G}
        string=${string//h/H}
        string=${string//i/I}
        string=${string//j/J}
        string=${string//k/K}
        string=${string//l/L}
        string=${string//m/M}
        string=${string//n/N}
        string=${string//o/O}
        string=${string//p/P}
        string=${string//q/Q}
        string=${string//r/R}
        string=${string//s/S}
        string=${string//t/T}
        string=${string//u/U}
        string=${string//v/V}
        string=${string//w/W}
        string=${string//x/X}
        string=${string//y/Y}
        string=${string//z/Z}
    else
        string=${string//a/A}
        string=${string//b/B}
        string=${string//c/C}
        string=${string//d/D}
        string=${string//e/E}
        string=${string//f/F}
        string=${string//g/G}
        string=${string//h/H}
        string=${string//i/I}
        string=${string//j/J}
        string=${string//k/K}
        string=${string//l/L}
        string=${string//m/M}
        string=${string//n/N}
        string=${string//o/O}
        string=${string//p/P}
        string=${string//q/Q}
        string=${string//r/R}
        string=${string//s/S}
        string=${string//t/T}
        string=${string//u/U}
        string=${string//v/V}
        string=${string//w/W}
        string=${string//x/X}
        string=${string//y/Y}
        string=${string//z/Z}
        string=${string//Âµ/Îœ}
        string=${string//Ã /Ã€}
        string=${string//Ã¡/Ã}
        string=${string//Ã¢/Ã‚}
        string=${string//Ã£/Ãƒ}
        string=${string//Ã¤/Ã„}
        string=${string//Ã¥/Ã…}
        string=${string//Ã¦/Ã†}
        string=${string//Ã§/Ã‡}
        string=${string//Ã¨/Ãˆ}
        string=${string//Ã©/Ã‰}
        string=${string//Ãª/ÃŠ}
        string=${string//Ã«/Ã‹}
        string=${string//Ã¬/ÃŒ}
        string=${string//Ã­/Ã}
        string=${string//Ã®/Ã}
        string=${string//Ã¯/Ã}
        string=${string//Ã°/Ã}
        string=${string//Ã±/Ã‘}
        string=${string//Ã²/Ã’}
        string=${string//Ã³/Ã“}
        string=${string//Ã´/Ã”}
        string=${string//Ãµ/Ã•}
        string=${string//Ã¶/Ã–}
        string=${string//Ã¸/Ã˜}
        string=${string//Ã¹/Ã™}
        string=${string//Ãº/Ãš}
        string=${string//Ã»/Ã›}
        string=${string//Ã¼/Ãœ}
        string=${string//Ã½/Ã}
        string=${string//Ã¾/Ã}
        string=${string//Ã¿/Å¸}
        string=${string//Ä/Ä€}
        string=${string//Äƒ/Ä‚}
        string=${string//Ä…/Ä„}
        string=${string//Ä‡/Ä†}
        string=${string//Ä‰/Äˆ}
        string=${string//Ä‹/ÄŠ}
        string=${string//Ä/ÄŒ}
        string=${string//Ä/Ä}
        string=${string//Ä‘/Ä}
        string=${string//Ä“/Ä’}
        string=${string//Ä•/Ä”}
        string=${string//Ä—/Ä–}
        string=${string//Ä™/Ä˜}
        string=${string//Ä›/Äš}
        string=${string//Ä/Äœ}
        string=${string//ÄŸ/Ä}
        string=${string//Ä¡/Ä }
        string=${string//Ä£/Ä¢}
        string=${string//Ä¥/Ä¤}
        string=${string//Ä§/Ä¦}
        string=${string//Ä©/Ä¨}
        string=${string//Ä«/Äª}
        string=${string//Ä­/Ä¬}
        string=${string//Ä¯/Ä®}
        string=${string//Ä±/I}
        string=${string//Ä³/Ä²}
        string=${string//Äµ/Ä´}
        string=${string//Ä·/Ä¶}
        string=${string//Äº/Ä¹}
        string=${string//Ä¼/Ä»}
        string=${string//Ä¾/Ä½}
        string=${string//Å€/Ä¿}
        string=${string//Å‚/Å}
        string=${string//Å„/Åƒ}
        string=${string//Å†/Å…}
        string=${string//Åˆ/Å‡}
        string=${string//Å‹/ÅŠ}
        string=${string//Å/ÅŒ}
        string=${string//Å/Å}
        string=${string//Å‘/Å}
        string=${string//Å“/Å’}
        string=${string//Å•/Å”}
        string=${string//Å—/Å–}
        string=${string//Å™/Å˜}
        string=${string//Å›/Åš}
        string=${string//Å/Åœ}
        string=${string//ÅŸ/Å}
        string=${string//Å¡/Å }
        string=${string//Å£/Å¢}
        string=${string//Å¥/Å¤}
        string=${string//Å§/Å¦}
        string=${string//Å©/Å¨}
        string=${string//Å«/Åª}
        string=${string//Å­/Å¬}
        string=${string//Å¯/Å®}
        string=${string//Å±/Å°}
        string=${string//Å³/Å²}
        string=${string//Åµ/Å´}
        string=${string//Å·/Å¶}
        string=${string//Åº/Å¹}
        string=${string//Å¼/Å»}
        string=${string//Å¾/Å½}
        string=${string//Å¿/S}
        string=${string//Æ€/Éƒ}
        string=${string//Æƒ/Æ‚}
        string=${string//Æ…/Æ„}
        string=${string//Æˆ/Æ‡}
        string=${string//ÆŒ/Æ‹}
        string=${string//Æ’/Æ‘}
        string=${string//Æ•/Ç¶}
        string=${string//Æ™/Æ˜}
        string=${string//Æš/È½}
        string=${string//Æ/È }
        string=${string//Æ¡/Æ }
        string=${string//Æ£/Æ¢}
        string=${string//Æ¥/Æ¤}
        string=${string//Æ¨/Æ§}
        string=${string//Æ­/Æ¬}
        string=${string//Æ°/Æ¯}
        string=${string//Æ´/Æ³}
        string=${string//Æ¶/Æµ}
        string=${string//Æ¹/Æ¸}
        string=${string//Æ½/Æ¼}
        string=${string//Æ¿/Ç·}
        string=${string//Ç…/Ç„}
        string=${string//Ç†/Ç„}
        string=${string//Çˆ/Ç‡}
        string=${string//Ç‰/Ç‡}
        string=${string//Ç‹/ÇŠ}
        string=${string//ÇŒ/ÇŠ}
        string=${string//Ç/Ç}
        string=${string//Ç/Ç}
        string=${string//Ç’/Ç‘}
        string=${string//Ç”/Ç“}
        string=${string//Ç–/Ç•}
        string=${string//Ç˜/Ç—}
        string=${string//Çš/Ç™}
        string=${string//Çœ/Ç›}
        string=${string//Ç/Æ}
        string=${string//ÇŸ/Ç}
        string=${string//Ç¡/Ç }
        string=${string//Ç£/Ç¢}
        string=${string//Ç¥/Ç¤}
        string=${string//Ç§/Ç¦}
        string=${string//Ç©/Ç¨}
        string=${string//Ç«/Çª}
        string=${string//Ç­/Ç¬}
        string=${string//Ç¯/Ç®}
        string=${string//Ç²/Ç±}
        string=${string//Ç³/Ç±}
        string=${string//Çµ/Ç´}
        string=${string//Ç¹/Ç¸}
        string=${string//Ç»/Çº}
        string=${string//Ç½/Ç¼}
        string=${string//Ç¿/Ç¾}
        string=${string//È/È€}
        string=${string//Èƒ/È‚}
        string=${string//È…/È„}
        string=${string//È‡/È†}
        string=${string//È‰/Èˆ}
        string=${string//È‹/ÈŠ}
        string=${string//È/ÈŒ}
        string=${string//È/È}
        string=${string//È‘/È}
        string=${string//È“/È’}
        string=${string//È•/È”}
        string=${string//È—/È–}
        string=${string//È™/È˜}
        string=${string//È›/Èš}
        string=${string//È/Èœ}
        string=${string//ÈŸ/È}
        string=${string//È£/È¢}
        string=${string//È¥/È¤}
        string=${string//È§/È¦}
        string=${string//È©/È¨}
        string=${string//È«/Èª}
        string=${string//È­/È¬}
        string=${string//È¯/È®}
        string=${string//È±/È°}
        string=${string//È³/È²}
        string=${string//È¼/È»}
        string=${string//È¿/â±¾}
        string=${string//É€/â±¿}
        string=${string//É‚/É}
        string=${string//É‡/É†}
        string=${string//É‰/Éˆ}
        string=${string//É‹/ÉŠ}
        string=${string//É/ÉŒ}
        string=${string//É/É}
        string=${string//É/â±¯}
        string=${string//É‘/â±­}
        string=${string//É’/â±°}
        string=${string//É“/Æ}
        string=${string//É”/Æ†}
        string=${string//É–/Æ‰}
        string=${string//É—/ÆŠ}
        string=${string//É™/Æ}
        string=${string//É›/Æ}
        string=${string//Éœ/ê«}
        string=${string//É /Æ“}
        string=${string//É¡/ê¬}
        string=${string//É£/Æ”}
        string=${string//É¥/ê}
        string=${string//É¦/êª}
        string=${string//É¨/Æ—}
        string=${string//É©/Æ–}
        string=${string//Éª/ê®}
        string=${string//É«/â±¢}
        string=${string//É¬/ê­}
        string=${string//É¯/Æœ}
        string=${string//É±/â±®}
        string=${string//É²/Æ}
        string=${string//Éµ/ÆŸ}
        string=${string//É½/â±¤}
        string=${string//Ê€/Æ¦}
        string=${string//Êƒ/Æ©}
        string=${string//Ê‡/ê±}
        string=${string//Êˆ/Æ®}
        string=${string//Ê‰/É„}
        string=${string//ÊŠ/Æ±}
        string=${string//Ê‹/Æ²}
        string=${string//ÊŒ/É…}
        string=${string//Ê’/Æ·}
        string=${string//Ê/ê²}
        string=${string//Ê/ê°}
        string=${string//Í…/Î™}
        string=${string//Í±/Í°}
        string=${string//Í³/Í²}
        string=${string//Í·/Í¶}
        string=${string//Í»/Ï½}
        string=${string//Í¼/Ï¾}
        string=${string//Í½/Ï¿}
        string=${string//Î¬/Î†}
        string=${string//Î­/Îˆ}
        string=${string//Î®/Î‰}
        string=${string//Î¯/ÎŠ}
        string=${string//Î±/Î‘}
        string=${string//Î²/Î’}
        string=${string//Î³/Î“}
        string=${string//Î´/Î”}
        string=${string//Îµ/Î•}
        string=${string//Î¶/Î–}
        string=${string//Î·/Î—}
        string=${string//Î¸/Î˜}
        string=${string//Î¹/Î™}
        string=${string//Îº/Îš}
        string=${string//Î»/Î›}
        string=${string//Î¼/Îœ}
        string=${string//Î½/Î}
        string=${string//Î¾/Î}
        string=${string//Î¿/ÎŸ}
        string=${string//Ï€/Î }
        string=${string//Ï/Î¡}
        string=${string//Ï‚/Î£}
        string=${string//Ïƒ/Î£}
        string=${string//Ï„/Î¤}
        string=${string//Ï…/Î¥}
        string=${string//Ï†/Î¦}
        string=${string//Ï‡/Î§}
        string=${string//Ïˆ/Î¨}
        string=${string//Ï‰/Î©}
        string=${string//ÏŠ/Îª}
        string=${string//Ï‹/Î«}
        string=${string//ÏŒ/ÎŒ}
        string=${string//Ï/Î}
        string=${string//Ï/Î}
        string=${string//Ï/Î’}
        string=${string//Ï‘/Î˜}
        string=${string//Ï•/Î¦}
        string=${string//Ï–/Î }
        string=${string//Ï—/Ï}
        string=${string//Ï™/Ï˜}
        string=${string//Ï›/Ïš}
        string=${string//Ï/Ïœ}
        string=${string//ÏŸ/Ï}
        string=${string//Ï¡/Ï }
        string=${string//Ï£/Ï¢}
        string=${string//Ï¥/Ï¤}
        string=${string//Ï§/Ï¦}
        string=${string//Ï©/Ï¨}
        string=${string//Ï«/Ïª}
        string=${string//Ï­/Ï¬}
        string=${string//Ï¯/Ï®}
        string=${string//Ï°/Îš}
        string=${string//Ï±/Î¡}
        string=${string//Ï²/Ï¹}
        string=${string//Ï³/Í¿}
        string=${string//Ïµ/Î•}
        string=${string//Ï¸/Ï·}
        string=${string//Ï»/Ïº}
        string=${string//Ğ°/Ğ}
        string=${string//Ğ±/Ğ‘}
        string=${string//Ğ²/Ğ’}
        string=${string//Ğ³/Ğ“}
        string=${string//Ğ´/Ğ”}
        string=${string//Ğµ/Ğ•}
        string=${string//Ğ¶/Ğ–}
        string=${string//Ğ·/Ğ—}
        string=${string//Ğ¸/Ğ˜}
        string=${string//Ğ¹/Ğ™}
        string=${string//Ğº/Ğš}
        string=${string//Ğ»/Ğ›}
        string=${string//Ğ¼/Ğœ}
        string=${string//Ğ½/Ğ}
        string=${string//Ğ¾/Ğ}
        string=${string//Ğ¿/ĞŸ}
        string=${string//Ñ€/Ğ }
        string=${string//Ñ/Ğ¡}
        string=${string//Ñ‚/Ğ¢}
        string=${string//Ñƒ/Ğ£}
        string=${string//Ñ„/Ğ¤}
        string=${string//Ñ…/Ğ¥}
        string=${string//Ñ†/Ğ¦}
        string=${string//Ñ‡/Ğ§}
        string=${string//Ñˆ/Ğ¨}
        string=${string//Ñ‰/Ğ©}
        string=${string//ÑŠ/Ğª}
        string=${string//Ñ‹/Ğ«}
        string=${string//ÑŒ/Ğ¬}
        string=${string//Ñ/Ğ­}
        string=${string//Ñ/Ğ®}
        string=${string//Ñ/Ğ¯}
        string=${string//Ñ/Ğ€}
        string=${string//Ñ‘/Ğ}
        string=${string//Ñ’/Ğ‚}
        string=${string//Ñ“/Ğƒ}
        string=${string//Ñ”/Ğ„}
        string=${string//Ñ•/Ğ…}
        string=${string//Ñ–/Ğ†}
        string=${string//Ñ—/Ğ‡}
        string=${string//Ñ˜/Ğˆ}
        string=${string//Ñ™/Ğ‰}
        string=${string//Ñš/ĞŠ}
        string=${string//Ñ›/Ğ‹}
        string=${string//Ñœ/ĞŒ}
        string=${string//Ñ/Ğ}
        string=${string//Ñ/Ğ}
        string=${string//ÑŸ/Ğ}
        string=${string//Ñ¡/Ñ }
        string=${string//Ñ£/Ñ¢}
        string=${string//Ñ¥/Ñ¤}
        string=${string//Ñ§/Ñ¦}
        string=${string//Ñ©/Ñ¨}
        string=${string//Ñ«/Ñª}
        string=${string//Ñ­/Ñ¬}
        string=${string//Ñ¯/Ñ®}
        string=${string//Ñ±/Ñ°}
        string=${string//Ñ³/Ñ²}
        string=${string//Ñµ/Ñ´}
        string=${string//Ñ·/Ñ¶}
        string=${string//Ñ¹/Ñ¸}
        string=${string//Ñ»/Ñº}
        string=${string//Ñ½/Ñ¼}
        string=${string//Ñ¿/Ñ¾}
        string=${string//Ò/Ò€}
        string=${string//Ò‹/ÒŠ}
        string=${string//Ò/ÒŒ}
        string=${string//Ò/Ò}
        string=${string//Ò‘/Ò}
        string=${string//Ò“/Ò’}
        string=${string//Ò•/Ò”}
        string=${string//Ò—/Ò–}
        string=${string//Ò™/Ò˜}
        string=${string//Ò›/Òš}
        string=${string//Ò/Òœ}
        string=${string//ÒŸ/Ò}
        string=${string//Ò¡/Ò }
        string=${string//Ò£/Ò¢}
        string=${string//Ò¥/Ò¤}
        string=${string//Ò§/Ò¦}
        string=${string//Ò©/Ò¨}
        string=${string//Ò«/Òª}
        string=${string//Ò­/Ò¬}
        string=${string//Ò¯/Ò®}
        string=${string//Ò±/Ò°}
        string=${string//Ò³/Ò²}
        string=${string//Òµ/Ò´}
        string=${string//Ò·/Ò¶}
        string=${string//Ò¹/Ò¸}
        string=${string//Ò»/Òº}
        string=${string//Ò½/Ò¼}
        string=${string//Ò¿/Ò¾}
        string=${string//Ó‚/Ó}
        string=${string//Ó„/Óƒ}
        string=${string//Ó†/Ó…}
        string=${string//Óˆ/Ó‡}
        string=${string//ÓŠ/Ó‰}
        string=${string//ÓŒ/Ó‹}
        string=${string//Ó/Ó}
        string=${string//Ó/Ó€}
        string=${string//Ó‘/Ó}
        string=${string//Ó“/Ó’}
        string=${string//Ó•/Ó”}
        string=${string//Ó—/Ó–}
        string=${string//Ó™/Ó˜}
        string=${string//Ó›/Óš}
        string=${string//Ó/Óœ}
        string=${string//ÓŸ/Ó}
        string=${string//Ó¡/Ó }
        string=${string//Ó£/Ó¢}
        string=${string//Ó¥/Ó¤}
        string=${string//Ó§/Ó¦}
        string=${string//Ó©/Ó¨}
        string=${string//Ó«/Óª}
        string=${string//Ó­/Ó¬}
        string=${string//Ó¯/Ó®}
        string=${string//Ó±/Ó°}
        string=${string//Ó³/Ó²}
        string=${string//Óµ/Ó´}
        string=${string//Ó·/Ó¶}
        string=${string//Ó¹/Ó¸}
        string=${string//Ó»/Óº}
        string=${string//Ó½/Ó¼}
        string=${string//Ó¿/Ó¾}
        string=${string//Ô/Ô€}
        string=${string//Ôƒ/Ô‚}
        string=${string//Ô…/Ô„}
        string=${string//Ô‡/Ô†}
        string=${string//Ô‰/Ôˆ}
        string=${string//Ô‹/ÔŠ}
        string=${string//Ô/ÔŒ}
        string=${string//Ô/Ô}
        string=${string//Ô‘/Ô}
        string=${string//Ô“/Ô’}
        string=${string//Ô•/Ô”}
        string=${string//Ô—/Ô–}
        string=${string//Ô™/Ô˜}
        string=${string//Ô›/Ôš}
        string=${string//Ô/Ôœ}
        string=${string//ÔŸ/Ô}
        string=${string//Ô¡/Ô }
        string=${string//Ô£/Ô¢}
        string=${string//Ô¥/Ô¤}
        string=${string//Ô§/Ô¦}
        string=${string//Ô©/Ô¨}
        string=${string//Ô«/Ôª}
        string=${string//Ô­/Ô¬}
        string=${string//Ô¯/Ô®}
        string=${string//Õ¡/Ô±}
        string=${string//Õ¢/Ô²}
        string=${string//Õ£/Ô³}
        string=${string//Õ¤/Ô´}
        string=${string//Õ¥/Ôµ}
        string=${string//Õ¦/Ô¶}
        string=${string//Õ§/Ô·}
        string=${string//Õ¨/Ô¸}
        string=${string//Õ©/Ô¹}
        string=${string//Õª/Ôº}
        string=${string//Õ«/Ô»}
        string=${string//Õ¬/Ô¼}
        string=${string//Õ­/Ô½}
        string=${string//Õ®/Ô¾}
        string=${string//Õ¯/Ô¿}
        string=${string//Õ°/Õ€}
        string=${string//Õ±/Õ}
        string=${string//Õ²/Õ‚}
        string=${string//Õ³/Õƒ}
        string=${string//Õ´/Õ„}
        string=${string//Õµ/Õ…}
        string=${string//Õ¶/Õ†}
        string=${string//Õ·/Õ‡}
        string=${string//Õ¸/Õˆ}
        string=${string//Õ¹/Õ‰}
        string=${string//Õº/ÕŠ}
        string=${string//Õ»/Õ‹}
        string=${string//Õ¼/ÕŒ}
        string=${string//Õ½/Õ}
        string=${string//Õ¾/Õ}
        string=${string//Õ¿/Õ}
        string=${string//Ö€/Õ}
        string=${string//Ö/Õ‘}
        string=${string//Ö‚/Õ’}
        string=${string//Öƒ/Õ“}
        string=${string//Ö„/Õ”}
        string=${string//Ö…/Õ•}
        string=${string//Ö†/Õ–}
        string=${string//á¸/á°}
        string=${string//á¹/á±}
        string=${string//áº/á²}
        string=${string//á»/á³}
        string=${string//á¼/á´}
        string=${string//á½/áµ}
        string=${string//á²€/Ğ’}
        string=${string//á²/Ğ”}
        string=${string//á²‚/Ğ}
        string=${string//á²ƒ/Ğ¡}
        string=${string//á²„/Ğ¢}
        string=${string//á²…/Ğ¢}
        string=${string//á²†/Ğª}
        string=${string//á²‡/Ñ¢}
        string=${string//á²ˆ/ê™Š}
        string=${string//áµ¹/ê½}
        string=${string//áµ½/â±£}
        string=${string//á¸/á¸€}
        string=${string//á¸ƒ/á¸‚}
        string=${string//á¸…/á¸„}
        string=${string//á¸‡/á¸†}
        string=${string//á¸‰/á¸ˆ}
        string=${string//á¸‹/á¸Š}
        string=${string//á¸/á¸Œ}
        string=${string//á¸/á¸}
        string=${string//á¸‘/á¸}
        string=${string//á¸“/á¸’}
        string=${string//á¸•/á¸”}
        string=${string//á¸—/á¸–}
        string=${string//á¸™/á¸˜}
        string=${string//á¸›/á¸š}
        string=${string//á¸/á¸œ}
        string=${string//á¸Ÿ/á¸}
        string=${string//á¸¡/á¸ }
        string=${string//á¸£/á¸¢}
        string=${string//á¸¥/á¸¤}
        string=${string//á¸§/á¸¦}
        string=${string//á¸©/á¸¨}
        string=${string//á¸«/á¸ª}
        string=${string//á¸­/á¸¬}
        string=${string//á¸¯/á¸®}
        string=${string//á¸±/á¸°}
        string=${string//á¸³/á¸²}
        string=${string//á¸µ/á¸´}
        string=${string//á¸·/á¸¶}
        string=${string//á¸¹/á¸¸}
        string=${string//á¸»/á¸º}
        string=${string//á¸½/á¸¼}
        string=${string//á¸¿/á¸¾}
        string=${string//á¹/á¹€}
        string=${string//á¹ƒ/á¹‚}
        string=${string//á¹…/á¹„}
        string=${string//á¹‡/á¹†}
        string=${string//á¹‰/á¹ˆ}
        string=${string//á¹‹/á¹Š}
        string=${string//á¹/á¹Œ}
        string=${string//á¹/á¹}
        string=${string//á¹‘/á¹}
        string=${string//á¹“/á¹’}
        string=${string//á¹•/á¹”}
        string=${string//á¹—/á¹–}
        string=${string//á¹™/á¹˜}
        string=${string//á¹›/á¹š}
        string=${string//á¹/á¹œ}
        string=${string//á¹Ÿ/á¹}
        string=${string//á¹¡/á¹ }
        string=${string//á¹£/á¹¢}
        string=${string//á¹¥/á¹¤}
        string=${string//á¹§/á¹¦}
        string=${string//á¹©/á¹¨}
        string=${string//á¹«/á¹ª}
        string=${string//á¹­/á¹¬}
        string=${string//á¹¯/á¹®}
        string=${string//á¹±/á¹°}
        string=${string//á¹³/á¹²}
        string=${string//á¹µ/á¹´}
        string=${string//á¹·/á¹¶}
        string=${string//á¹¹/á¹¸}
        string=${string//á¹»/á¹º}
        string=${string//á¹½/á¹¼}
        string=${string//á¹¿/á¹¾}
        string=${string//áº/áº€}
        string=${string//áºƒ/áº‚}
        string=${string//áº…/áº„}
        string=${string//áº‡/áº†}
        string=${string//áº‰/áºˆ}
        string=${string//áº‹/áºŠ}
        string=${string//áº/áºŒ}
        string=${string//áº/áº}
        string=${string//áº‘/áº}
        string=${string//áº“/áº’}
        string=${string//áº•/áº”}
        string=${string//áº›/á¹ }
        string=${string//áº¡/áº }
        string=${string//áº£/áº¢}
        string=${string//áº¥/áº¤}
        string=${string//áº§/áº¦}
        string=${string//áº©/áº¨}
        string=${string//áº«/áºª}
        string=${string//áº­/áº¬}
        string=${string//áº¯/áº®}
        string=${string//áº±/áº°}
        string=${string//áº³/áº²}
        string=${string//áºµ/áº´}
        string=${string//áº·/áº¶}
        string=${string//áº¹/áº¸}
        string=${string//áº»/áºº}
        string=${string//áº½/áº¼}
        string=${string//áº¿/áº¾}
        string=${string//á»/á»€}
        string=${string//á»ƒ/á»‚}
        string=${string//á»…/á»„}
        string=${string//á»‡/á»†}
        string=${string//á»‰/á»ˆ}
        string=${string//á»‹/á»Š}
        string=${string//á»/á»Œ}
        string=${string//á»/á»}
        string=${string//á»‘/á»}
        string=${string//á»“/á»’}
        string=${string//á»•/á»”}
        string=${string//á»—/á»–}
        string=${string//á»™/á»˜}
        string=${string//á»›/á»š}
        string=${string//á»/á»œ}
        string=${string//á»Ÿ/á»}
        string=${string//á»¡/á» }
        string=${string//á»£/á»¢}
        string=${string//á»¥/á»¤}
        string=${string//á»§/á»¦}
        string=${string//á»©/á»¨}
        string=${string//á»«/á»ª}
        string=${string//á»­/á»¬}
        string=${string//á»¯/á»®}
        string=${string//á»±/á»°}
        string=${string//á»³/á»²}
        string=${string//á»µ/á»´}
        string=${string//á»·/á»¶}
        string=${string//á»¹/á»¸}
        string=${string//á»»/á»º}
        string=${string//á»½/á»¼}
        string=${string//á»¿/á»¾}
        string=${string//á¼€/á¼ˆ}
        string=${string//á¼/á¼‰}
        string=${string//á¼‚/á¼Š}
        string=${string//á¼ƒ/á¼‹}
        string=${string//á¼„/á¼Œ}
        string=${string//á¼…/á¼}
        string=${string//á¼†/á¼}
        string=${string//á¼‡/á¼}
        string=${string//á¼/á¼˜}
        string=${string//á¼‘/á¼™}
        string=${string//á¼’/á¼š}
        string=${string//á¼“/á¼›}
        string=${string//á¼”/á¼œ}
        string=${string//á¼•/á¼}
        string=${string//á¼ /á¼¨}
        string=${string//á¼¡/á¼©}
        string=${string//á¼¢/á¼ª}
        string=${string//á¼£/á¼«}
        string=${string//á¼¤/á¼¬}
        string=${string//á¼¥/á¼­}
        string=${string//á¼¦/á¼®}
        string=${string//á¼§/á¼¯}
        string=${string//á¼°/á¼¸}
        string=${string//á¼±/á¼¹}
        string=${string//á¼²/á¼º}
        string=${string//á¼³/á¼»}
        string=${string//á¼´/á¼¼}
        string=${string//á¼µ/á¼½}
        string=${string//á¼¶/á¼¾}
        string=${string//á¼·/á¼¿}
        string=${string//á½€/á½ˆ}
        string=${string//á½/á½‰}
        string=${string//á½‚/á½Š}
        string=${string//á½ƒ/á½‹}
        string=${string//á½„/á½Œ}
        string=${string//á½…/á½}
        string=${string//á½‘/á½™}
        string=${string//á½“/á½›}
        string=${string//á½•/á½}
        string=${string//á½—/á½Ÿ}
        string=${string//á½ /á½¨}
        string=${string//á½¡/á½©}
        string=${string//á½¢/á½ª}
        string=${string//á½£/á½«}
        string=${string//á½¤/á½¬}
        string=${string//á½¥/á½­}
        string=${string//á½¦/á½®}
        string=${string//á½§/á½¯}
        string=${string//á½°/á¾º}
        string=${string//á½±/á¾»}
        string=${string//á½²/á¿ˆ}
        string=${string//á½³/á¿‰}
        string=${string//á½´/á¿Š}
        string=${string//á½µ/á¿‹}
        string=${string//á½¶/á¿š}
        string=${string//á½·/á¿›}
        string=${string//á½¸/á¿¸}
        string=${string//á½¹/á¿¹}
        string=${string//á½º/á¿ª}
        string=${string//á½»/á¿«}
        string=${string//á½¼/á¿º}
        string=${string//á½½/á¿»}
        string=${string//á¾€/á¾ˆ}
        string=${string//á¾/á¾‰}
        string=${string//á¾‚/á¾Š}
        string=${string//á¾ƒ/á¾‹}
        string=${string//á¾„/á¾Œ}
        string=${string//á¾…/á¾}
        string=${string//á¾†/á¾}
        string=${string//á¾‡/á¾}
        string=${string//á¾/á¾˜}
        string=${string//á¾‘/á¾™}
        string=${string//á¾’/á¾š}
        string=${string//á¾“/á¾›}
        string=${string//á¾”/á¾œ}
        string=${string//á¾•/á¾}
        string=${string//á¾–/á¾}
        string=${string//á¾—/á¾Ÿ}
        string=${string//á¾ /á¾¨}
        string=${string//á¾¡/á¾©}
        string=${string//á¾¢/á¾ª}
        string=${string//á¾£/á¾«}
        string=${string//á¾¤/á¾¬}
        string=${string//á¾¥/á¾­}
        string=${string//á¾¦/á¾®}
        string=${string//á¾§/á¾¯}
        string=${string//á¾°/á¾¸}
        string=${string//á¾±/á¾¹}
        string=${string//á¾³/á¾¼}
        string=${string//á¾¾/Î™}
        string=${string//á¿ƒ/á¿Œ}
        string=${string//á¿/á¿˜}
        string=${string//á¿‘/á¿™}
        string=${string//á¿ /á¿¨}
        string=${string//á¿¡/á¿©}
        string=${string//á¿¥/á¿¬}
        string=${string//á¿³/á¿¼}
        string=${string//â…/â„²}
        string=${string//â…°/â… }
        string=${string//â…±/â…¡}
        string=${string//â…²/â…¢}
        string=${string//â…³/â…£}
        string=${string//â…´/â…¤}
        string=${string//â…µ/â…¥}
        string=${string//â…¶/â…¦}
        string=${string//â…·/â…§}
        string=${string//â…¸/â…¨}
        string=${string//â…¹/â…©}
        string=${string//â…º/â…ª}
        string=${string//â…»/â…«}
        string=${string//â…¼/â…¬}
        string=${string//â…½/â…­}
        string=${string//â…¾/â…®}
        string=${string//â…¿/â…¯}
        string=${string//â†„/â†ƒ}
        string=${string//â“/â’¶}
        string=${string//â“‘/â’·}
        string=${string//â“’/â’¸}
        string=${string//â““/â’¹}
        string=${string//â“”/â’º}
        string=${string//â“•/â’»}
        string=${string//â“–/â’¼}
        string=${string//â“—/â’½}
        string=${string//â“˜/â’¾}
        string=${string//â“™/â’¿}
        string=${string//â“š/â“€}
        string=${string//â“›/â“}
        string=${string//â“œ/â“‚}
        string=${string//â“/â“ƒ}
        string=${string//â“/â“„}
        string=${string//â“Ÿ/â“…}
        string=${string//â“ /â“†}
        string=${string//â“¡/â“‡}
        string=${string//â“¢/â“ˆ}
        string=${string//â“£/â“‰}
        string=${string//â“¤/â“Š}
        string=${string//â“¥/â“‹}
        string=${string//â“¦/â“Œ}
        string=${string//â“§/â“}
        string=${string//â“¨/â“}
        string=${string//â“©/â“}
        string=${string//â°°/â°€}
        string=${string//â°±/â°}
        string=${string//â°²/â°‚}
        string=${string//â°³/â°ƒ}
        string=${string//â°´/â°„}
        string=${string//â°µ/â°…}
        string=${string//â°¶/â°†}
        string=${string//â°·/â°‡}
        string=${string//â°¸/â°ˆ}
        string=${string//â°¹/â°‰}
        string=${string//â°º/â°Š}
        string=${string//â°»/â°‹}
        string=${string//â°¼/â°Œ}
        string=${string//â°½/â°}
        string=${string//â°¾/â°}
        string=${string//â°¿/â°}
        string=${string//â±€/â°}
        string=${string//â±/â°‘}
        string=${string//â±‚/â°’}
        string=${string//â±ƒ/â°“}
        string=${string//â±„/â°”}
        string=${string//â±…/â°•}
        string=${string//â±†/â°–}
        string=${string//â±‡/â°—}
        string=${string//â±ˆ/â°˜}
        string=${string//â±‰/â°™}
        string=${string//â±Š/â°š}
        string=${string//â±‹/â°›}
        string=${string//â±Œ/â°œ}
        string=${string//â±/â°}
        string=${string//â±/â°}
        string=${string//â±/â°Ÿ}
        string=${string//â±/â° }
        string=${string//â±‘/â°¡}
        string=${string//â±’/â°¢}
        string=${string//â±“/â°£}
        string=${string//â±”/â°¤}
        string=${string//â±•/â°¥}
        string=${string//â±–/â°¦}
        string=${string//â±—/â°§}
        string=${string//â±˜/â°¨}
        string=${string//â±™/â°©}
        string=${string//â±š/â°ª}
        string=${string//â±›/â°«}
        string=${string//â±œ/â°¬}
        string=${string//â±/â°­}
        string=${string//â±/â°®}
        string=${string//â±¡/â± }
        string=${string//â±¥/Èº}
        string=${string//â±¦/È¾}
        string=${string//â±¨/â±§}
        string=${string//â±ª/â±©}
        string=${string//â±¬/â±«}
        string=${string//â±³/â±²}
        string=${string//â±¶/â±µ}
        string=${string//â²/â²€}
        string=${string//â²ƒ/â²‚}
        string=${string//â²…/â²„}
        string=${string//â²‡/â²†}
        string=${string//â²‰/â²ˆ}
        string=${string//â²‹/â²Š}
        string=${string//â²/â²Œ}
        string=${string//â²/â²}
        string=${string//â²‘/â²}
        string=${string//â²“/â²’}
        string=${string//â²•/â²”}
        string=${string//â²—/â²–}
        string=${string//â²™/â²˜}
        string=${string//â²›/â²š}
        string=${string//â²/â²œ}
        string=${string//â²Ÿ/â²}
        string=${string//â²¡/â² }
        string=${string//â²£/â²¢}
        string=${string//â²¥/â²¤}
        string=${string//â²§/â²¦}
        string=${string//â²©/â²¨}
        string=${string//â²«/â²ª}
        string=${string//â²­/â²¬}
        string=${string//â²¯/â²®}
        string=${string//â²±/â²°}
        string=${string//â²³/â²²}
        string=${string//â²µ/â²´}
        string=${string//â²·/â²¶}
        string=${string//â²¹/â²¸}
        string=${string//â²»/â²º}
        string=${string//â²½/â²¼}
        string=${string//â²¿/â²¾}
        string=${string//â³/â³€}
        string=${string//â³ƒ/â³‚}
        string=${string//â³…/â³„}
        string=${string//â³‡/â³†}
        string=${string//â³‰/â³ˆ}
        string=${string//â³‹/â³Š}
        string=${string//â³/â³Œ}
        string=${string//â³/â³}
        string=${string//â³‘/â³}
        string=${string//â³“/â³’}
        string=${string//â³•/â³”}
        string=${string//â³—/â³–}
        string=${string//â³™/â³˜}
        string=${string//â³›/â³š}
        string=${string//â³/â³œ}
        string=${string//â³Ÿ/â³}
        string=${string//â³¡/â³ }
        string=${string//â³£/â³¢}
        string=${string//â³¬/â³«}
        string=${string//â³®/â³­}
        string=${string//â³³/â³²}
        string=${string//â´€/á‚ }
        string=${string//â´/á‚¡}
        string=${string//â´‚/á‚¢}
        string=${string//â´ƒ/á‚£}
        string=${string//â´„/á‚¤}
        string=${string//â´…/á‚¥}
        string=${string//â´†/á‚¦}
        string=${string//â´‡/á‚§}
        string=${string//â´ˆ/á‚¨}
        string=${string//â´‰/á‚©}
        string=${string//â´Š/á‚ª}
        string=${string//â´‹/á‚«}
        string=${string//â´Œ/á‚¬}
        string=${string//â´/á‚­}
        string=${string//â´/á‚®}
        string=${string//â´/á‚¯}
        string=${string//â´/á‚°}
        string=${string//â´‘/á‚±}
        string=${string//â´’/á‚²}
        string=${string//â´“/á‚³}
        string=${string//â´”/á‚´}
        string=${string//â´•/á‚µ}
        string=${string//â´–/á‚¶}
        string=${string//â´—/á‚·}
        string=${string//â´˜/á‚¸}
        string=${string//â´™/á‚¹}
        string=${string//â´š/á‚º}
        string=${string//â´›/á‚»}
        string=${string//â´œ/á‚¼}
        string=${string//â´/á‚½}
        string=${string//â´/á‚¾}
        string=${string//â´Ÿ/á‚¿}
        string=${string//â´ /áƒ€}
        string=${string//â´¡/áƒ}
        string=${string//â´¢/áƒ‚}
        string=${string//â´£/áƒƒ}
        string=${string//â´¤/áƒ„}
        string=${string//â´¥/áƒ…}
        string=${string//â´§/áƒ‡}
        string=${string//â´­/áƒ}
        string=${string//ê™/ê™€}
        string=${string//ê™ƒ/ê™‚}
        string=${string//ê™…/ê™„}
        string=${string//ê™‡/ê™†}
        string=${string//ê™‰/ê™ˆ}
        string=${string//ê™‹/ê™Š}
        string=${string//ê™/ê™Œ}
        string=${string//ê™/ê™}
        string=${string//ê™‘/ê™}
        string=${string//ê™“/ê™’}
        string=${string//ê™•/ê™”}
        string=${string//ê™—/ê™–}
        string=${string//ê™™/ê™˜}
        string=${string//ê™›/ê™š}
        string=${string//ê™/ê™œ}
        string=${string//ê™Ÿ/ê™}
        string=${string//ê™¡/ê™ }
        string=${string//ê™£/ê™¢}
        string=${string//ê™¥/ê™¤}
        string=${string//ê™§/ê™¦}
        string=${string//ê™©/ê™¨}
        string=${string//ê™«/ê™ª}
        string=${string//ê™­/ê™¬}
        string=${string//êš/êš€}
        string=${string//êšƒ/êš‚}
        string=${string//êš…/êš„}
        string=${string//êš‡/êš†}
        string=${string//êš‰/êšˆ}
        string=${string//êš‹/êšŠ}
        string=${string//êš/êšŒ}
        string=${string//êš/êš}
        string=${string//êš‘/êš}
        string=${string//êš“/êš’}
        string=${string//êš•/êš”}
        string=${string//êš—/êš–}
        string=${string//êš™/êš˜}
        string=${string//êš›/êšš}
        string=${string//êœ£/êœ¢}
        string=${string//êœ¥/êœ¤}
        string=${string//êœ§/êœ¦}
        string=${string//êœ©/êœ¨}
        string=${string//êœ«/êœª}
        string=${string//êœ­/êœ¬}
        string=${string//êœ¯/êœ®}
        string=${string//êœ³/êœ²}
        string=${string//êœµ/êœ´}
        string=${string//êœ·/êœ¶}
        string=${string//êœ¹/êœ¸}
        string=${string//êœ»/êœº}
        string=${string//êœ½/êœ¼}
        string=${string//êœ¿/êœ¾}
        string=${string//ê/ê€}
        string=${string//êƒ/ê‚}
        string=${string//ê…/ê„}
        string=${string//ê‡/ê†}
        string=${string//ê‰/êˆ}
        string=${string//ê‹/êŠ}
        string=${string//ê/êŒ}
        string=${string//ê/ê}
        string=${string//ê‘/ê}
        string=${string//ê“/ê’}
        string=${string//ê•/ê”}
        string=${string//ê—/ê–}
        string=${string//ê™/ê˜}
        string=${string//ê›/êš}
        string=${string//ê/êœ}
        string=${string//êŸ/ê}
        string=${string//ê¡/ê }
        string=${string//ê£/ê¢}
        string=${string//ê¥/ê¤}
        string=${string//ê§/ê¦}
        string=${string//ê©/ê¨}
        string=${string//ê«/êª}
        string=${string//ê­/ê¬}
        string=${string//ê¯/ê®}
        string=${string//êº/ê¹}
        string=${string//ê¼/ê»}
        string=${string//ê¿/ê¾}
        string=${string//ê/ê€}
        string=${string//êƒ/ê‚}
        string=${string//ê…/ê„}
        string=${string//ê‡/ê†}
        string=${string//êŒ/ê‹}
        string=${string//ê‘/ê}
        string=${string//ê“/ê’}
        string=${string//ê—/ê–}
        string=${string//ê™/ê˜}
        string=${string//ê›/êš}
        string=${string//ê/êœ}
        string=${string//êŸ/ê}
        string=${string//ê¡/ê }
        string=${string//ê£/ê¢}
        string=${string//ê¥/ê¤}
        string=${string//ê§/ê¦}
        string=${string//ê©/ê¨}
        string=${string//êµ/ê´}
        string=${string//ê·/ê¶}
        string=${string//ê­“/ê³}
        string=${string//ê­°/á }
        string=${string//ê­±/á¡}
        string=${string//ê­²/á¢}
        string=${string//ê­³/á£}
        string=${string//ê­´/á¤}
        string=${string//ê­µ/á¥}
        string=${string//ê­¶/á¦}
        string=${string//ê­·/á§}
        string=${string//ê­¸/á¨}
        string=${string//ê­¹/á©}
        string=${string//ê­º/áª}
        string=${string//ê­»/á«}
        string=${string//ê­¼/á¬}
        string=${string//ê­½/á­}
        string=${string//ê­¾/á®}
        string=${string//ê­¿/á¯}
        string=${string//ê®€/á°}
        string=${string//ê®/á±}
        string=${string//ê®‚/á²}
        string=${string//ê®ƒ/á³}
        string=${string//ê®„/á´}
        string=${string//ê®…/áµ}
        string=${string//ê®†/á¶}
        string=${string//ê®‡/á·}
        string=${string//ê®ˆ/á¸}
        string=${string//ê®‰/á¹}
        string=${string//ê®Š/áº}
        string=${string//ê®‹/á»}
        string=${string//ê®Œ/á¼}
        string=${string//ê®/á½}
        string=${string//ê®/á¾}
        string=${string//ê®/á¿}
        string=${string//ê®/á€}
        string=${string//ê®‘/á}
        string=${string//ê®’/á‚}
        string=${string//ê®“/áƒ}
        string=${string//ê®”/á„}
        string=${string//ê®•/á…}
        string=${string//ê®–/á†}
        string=${string//ê®—/á‡}
        string=${string//ê®˜/áˆ}
        string=${string//ê®™/á‰}
        string=${string//ê®š/áŠ}
        string=${string//ê®›/á‹}
        string=${string//ê®œ/áŒ}
        string=${string//ê®/á}
        string=${string//ê®/á}
        string=${string//ê®Ÿ/á}
        string=${string//ê® /á}
        string=${string//ê®¡/á‘}
        string=${string//ê®¢/á’}
        string=${string//ê®£/á“}
        string=${string//ê®¤/á”}
        string=${string//ê®¥/á•}
        string=${string//ê®¦/á–}
        string=${string//ê®§/á—}
        string=${string//ê®¨/á˜}
        string=${string//ê®©/á™}
        string=${string//ê®ª/áš}
        string=${string//ê®«/á›}
        string=${string//ê®¬/áœ}
        string=${string//ê®­/á}
        string=${string//ê®®/á}
        string=${string//ê®¯/áŸ}
        string=${string//ê®°/á }
        string=${string//ê®±/á¡}
        string=${string//ê®²/á¢}
        string=${string//ê®³/á£}
        string=${string//ê®´/á¤}
        string=${string//ê®µ/á¥}
        string=${string//ê®¶/á¦}
        string=${string//ê®·/á§}
        string=${string//ê®¸/á¨}
        string=${string//ê®¹/á©}
        string=${string//ê®º/áª}
        string=${string//ê®»/á«}
        string=${string//ê®¼/á¬}
        string=${string//ê®½/á­}
        string=${string//ê®¾/á®}
        string=${string//ê®¿/á¯}
        string=${string//ï½/ï¼¡}
        string=${string//ï½‚/ï¼¢}
        string=${string//ï½ƒ/ï¼£}
        string=${string//ï½„/ï¼¤}
        string=${string//ï½…/ï¼¥}
        string=${string//ï½†/ï¼¦}
        string=${string//ï½‡/ï¼§}
        string=${string//ï½ˆ/ï¼¨}
        string=${string//ï½‰/ï¼©}
        string=${string//ï½Š/ï¼ª}
        string=${string//ï½‹/ï¼«}
        string=${string//ï½Œ/ï¼¬}
        string=${string//ï½/ï¼­}
        string=${string//ï½/ï¼®}
        string=${string//ï½/ï¼¯}
        string=${string//ï½/ï¼°}
        string=${string//ï½‘/ï¼±}
        string=${string//ï½’/ï¼²}
        string=${string//ï½“/ï¼³}
        string=${string//ï½”/ï¼´}
        string=${string//ï½•/ï¼µ}
        string=${string//ï½–/ï¼¶}
        string=${string//ï½—/ï¼·}
        string=${string//ï½˜/ï¼¸}
        string=${string//ï½™/ï¼¹}
        string=${string//ï½š/ï¼º}
        string=${string//ğ¨/ğ€}
        string=${string//ğ©/ğ}
        string=${string//ğª/ğ‚}
        string=${string//ğ«/ğƒ}
        string=${string//ğ¬/ğ„}
        string=${string//ğ­/ğ…}
        string=${string//ğ®/ğ†}
        string=${string//ğ¯/ğ‡}
        string=${string//ğ°/ğˆ}
        string=${string//ğ±/ğ‰}
        string=${string//ğ²/ğŠ}
        string=${string//ğ³/ğ‹}
        string=${string//ğ´/ğŒ}
        string=${string//ğµ/ğ}
        string=${string//ğ¶/ğ}
        string=${string//ğ·/ğ}
        string=${string//ğ¸/ğ}
        string=${string//ğ¹/ğ‘}
        string=${string//ğº/ğ’}
        string=${string//ğ»/ğ“}
        string=${string//ğ¼/ğ”}
        string=${string//ğ½/ğ•}
        string=${string//ğ¾/ğ–}
        string=${string//ğ¿/ğ—}
        string=${string//ğ‘€/ğ˜}
        string=${string//ğ‘/ğ™}
        string=${string//ğ‘‚/ğš}
        string=${string//ğ‘ƒ/ğ›}
        string=${string//ğ‘„/ğœ}
        string=${string//ğ‘…/ğ}
        string=${string//ğ‘†/ğ}
        string=${string//ğ‘‡/ğŸ}
        string=${string//ğ‘ˆ/ğ }
        string=${string//ğ‘‰/ğ¡}
        string=${string//ğ‘Š/ğ¢}
        string=${string//ğ‘‹/ğ£}
        string=${string//ğ‘Œ/ğ¤}
        string=${string//ğ‘/ğ¥}
        string=${string//ğ‘/ğ¦}
        string=${string//ğ‘/ğ§}
        string=${string//ğ“˜/ğ’°}
        string=${string//ğ“™/ğ’±}
        string=${string//ğ“š/ğ’²}
        string=${string//ğ“›/ğ’³}
        string=${string//ğ“œ/ğ’´}
        string=${string//ğ“/ğ’µ}
        string=${string//ğ“/ğ’¶}
        string=${string//ğ“Ÿ/ğ’·}
        string=${string//ğ“ /ğ’¸}
        string=${string//ğ“¡/ğ’¹}
        string=${string//ğ“¢/ğ’º}
        string=${string//ğ“£/ğ’»}
        string=${string//ğ“¤/ğ’¼}
        string=${string//ğ“¥/ğ’½}
        string=${string//ğ“¦/ğ’¾}
        string=${string//ğ“§/ğ’¿}
        string=${string//ğ“¨/ğ“€}
        string=${string//ğ“©/ğ“}
        string=${string//ğ“ª/ğ“‚}
        string=${string//ğ“«/ğ“ƒ}
        string=${string//ğ“¬/ğ“„}
        string=${string//ğ“­/ğ“…}
        string=${string//ğ“®/ğ“†}
        string=${string//ğ“¯/ğ“‡}
        string=${string//ğ“°/ğ“ˆ}
        string=${string//ğ“±/ğ“‰}
        string=${string//ğ“²/ğ“Š}
        string=${string//ğ“³/ğ“‹}
        string=${string//ğ“´/ğ“Œ}
        string=${string//ğ“µ/ğ“}
        string=${string//ğ“¶/ğ“}
        string=${string//ğ“·/ğ“}
        string=${string//ğ“¸/ğ“}
        string=${string//ğ“¹/ğ“‘}
        string=${string//ğ“º/ğ“’}
        string=${string//ğ“»/ğ““}
        string=${string//ğ³€/ğ²€}
        string=${string//ğ³/ğ²}
        string=${string//ğ³‚/ğ²‚}
        string=${string//ğ³ƒ/ğ²ƒ}
        string=${string//ğ³„/ğ²„}
        string=${string//ğ³…/ğ²…}
        string=${string//ğ³†/ğ²†}
        string=${string//ğ³‡/ğ²‡}
        string=${string//ğ³ˆ/ğ²ˆ}
        string=${string//ğ³‰/ğ²‰}
        string=${string//ğ³Š/ğ²Š}
        string=${string//ğ³‹/ğ²‹}
        string=${string//ğ³Œ/ğ²Œ}
        string=${string//ğ³/ğ²}
        string=${string//ğ³/ğ²}
        string=${string//ğ³/ğ²}
        string=${string//ğ³/ğ²}
        string=${string//ğ³‘/ğ²‘}
        string=${string//ğ³’/ğ²’}
        string=${string//ğ³“/ğ²“}
        string=${string//ğ³”/ğ²”}
        string=${string//ğ³•/ğ²•}
        string=${string//ğ³–/ğ²–}
        string=${string//ğ³—/ğ²—}
        string=${string//ğ³˜/ğ²˜}
        string=${string//ğ³™/ğ²™}
        string=${string//ğ³š/ğ²š}
        string=${string//ğ³›/ğ²›}
        string=${string//ğ³œ/ğ²œ}
        string=${string//ğ³/ğ²}
        string=${string//ğ³/ğ²}
        string=${string//ğ³Ÿ/ğ²Ÿ}
        string=${string//ğ³ /ğ² }
        string=${string//ğ³¡/ğ²¡}
        string=${string//ğ³¢/ğ²¢}
        string=${string//ğ³£/ğ²£}
        string=${string//ğ³¤/ğ²¤}
        string=${string//ğ³¥/ğ²¥}
        string=${string//ğ³¦/ğ²¦}
        string=${string//ğ³§/ğ²§}
        string=${string//ğ³¨/ğ²¨}
        string=${string//ğ³©/ğ²©}
        string=${string//ğ³ª/ğ²ª}
        string=${string//ğ³«/ğ²«}
        string=${string//ğ³¬/ğ²¬}
        string=${string//ğ³­/ğ²­}
        string=${string//ğ³®/ğ²®}
        string=${string//ğ³¯/ğ²¯}
        string=${string//ğ³°/ğ²°}
        string=${string//ğ³±/ğ²±}
        string=${string//ğ³²/ğ²²}
        string=${string//ğ‘£€/ğ‘¢ }
        string=${string//ğ‘£/ğ‘¢¡}
        string=${string//ğ‘£‚/ğ‘¢¢}
        string=${string//ğ‘£ƒ/ğ‘¢£}
        string=${string//ğ‘£„/ğ‘¢¤}
        string=${string//ğ‘£…/ğ‘¢¥}
        string=${string//ğ‘£†/ğ‘¢¦}
        string=${string//ğ‘£‡/ğ‘¢§}
        string=${string//ğ‘£ˆ/ğ‘¢¨}
        string=${string//ğ‘£‰/ğ‘¢©}
        string=${string//ğ‘£Š/ğ‘¢ª}
        string=${string//ğ‘£‹/ğ‘¢«}
        string=${string//ğ‘£Œ/ğ‘¢¬}
        string=${string//ğ‘£/ğ‘¢­}
        string=${string//ğ‘£/ğ‘¢®}
        string=${string//ğ‘£/ğ‘¢¯}
        string=${string//ğ‘£/ğ‘¢°}
        string=${string//ğ‘£‘/ğ‘¢±}
        string=${string//ğ‘£’/ğ‘¢²}
        string=${string//ğ‘£“/ğ‘¢³}
        string=${string//ğ‘£”/ğ‘¢´}
        string=${string//ğ‘£•/ğ‘¢µ}
        string=${string//ğ‘£–/ğ‘¢¶}
        string=${string//ğ‘£—/ğ‘¢·}
        string=${string//ğ‘£˜/ğ‘¢¸}
        string=${string//ğ‘£™/ğ‘¢¹}
        string=${string//ğ‘£š/ğ‘¢º}
        string=${string//ğ‘£›/ğ‘¢»}
        string=${string//ğ‘£œ/ğ‘¢¼}
        string=${string//ğ‘£/ğ‘¢½}
        string=${string//ğ‘£/ğ‘¢¾}
        string=${string//ğ‘£Ÿ/ğ‘¢¿}
        string=${string//ğ¤¢/ğ¤€}
        string=${string//ğ¤£/ğ¤}
        string=${string//ğ¤¤/ğ¤‚}
        string=${string//ğ¤¥/ğ¤ƒ}
        string=${string//ğ¤¦/ğ¤„}
        string=${string//ğ¤§/ğ¤…}
        string=${string//ğ¤¨/ğ¤†}
        string=${string//ğ¤©/ğ¤‡}
        string=${string//ğ¤ª/ğ¤ˆ}
        string=${string//ğ¤«/ğ¤‰}
        string=${string//ğ¤¬/ğ¤Š}
        string=${string//ğ¤­/ğ¤‹}
        string=${string//ğ¤®/ğ¤Œ}
        string=${string//ğ¤¯/ğ¤}
        string=${string//ğ¤°/ğ¤}
        string=${string//ğ¤±/ğ¤}
        string=${string//ğ¤²/ğ¤}
        string=${string//ğ¤³/ğ¤‘}
        string=${string//ğ¤´/ğ¤’}
        string=${string//ğ¤µ/ğ¤“}
        string=${string//ğ¤¶/ğ¤”}
        string=${string//ğ¤·/ğ¤•}
        string=${string//ğ¤¸/ğ¤–}
        string=${string//ğ¤¹/ğ¤—}
        string=${string//ğ¤º/ğ¤˜}
        string=${string//ğ¤»/ğ¤™}
        string=${string//ğ¤¼/ğ¤š}
        string=${string//ğ¤½/ğ¤›}
        string=${string//ğ¤¾/ğ¤œ}
        string=${string//ğ¤¿/ğ¤}
        string=${string//ğ¥€/ğ¤}
        string=${string//ğ¥/ğ¤Ÿ}
        string=${string//ğ¥‚/ğ¤ }
        string=${string//ğ¥ƒ/ğ¤¡}
    fi

    local "${1-}" && assign::value "$1" "$string"
}

if [[ "${BASH_VERSINFO[0]}" -lt 4 ]] || [[ "${BASH_VERSINFO[0]}" -eq 4 && "${BASH_VERSINFO[1]}" -lt 2 ]]; then
    #: Use the fallback because the faster method is not available.
    string::toUpper() {
        string::toUpperFallback "$1" "$2"
    }
fi


# Trim leading and trailing whitespace from a string.
#
# $1 - Name of variable to store trimmed string.
# $2 - The string.
#
# Returns nothing.
string::trim() {
    local result

    string::trimStrings result "$2" true true $'\r' $'\n' $'\t' " "

    local "${1-}" && assign::value "$1" "$result"
}


# Trim strings from the front or end of a string.
#
# $1   - Name of destination variable.
# $2   - The string.
# $3   - true/false - trim front?
# $4   - true/false - trim end?
# $5-@ - What to trim, each as separate arguments.
#
# Returns nothing.
string::trimStrings() {
    local back current front last remove target

    target=${1-}
    current=${2-}
    front=${3-}
    back=${4-}
    last=""
    shift 4 # Remove target, string, trim front flag, trim end flag

    while [[ "$current" != "$last" ]]; do
        last=$current

        for remove in "$@"; do
            $front && current="${current/#$remove}"
            $back && current="${current/%$remove}"
        done
    done

    local "$target" && assign::value "$target" "$current"
}


bpm_include_array=$0
#!/usr/bin/env bash

. bpm
bpm::include assign


# Determines if a value is in an array.
#
# $1    - The value to seek in the array.
# $2-$@ - Array elements.
#
# Examples
#
#   local index list
#
#   list=(one two three "four four")
#
#   if array::contains one "${list[@]}"; then
#       # This one works
#       echo "one is found"
#   fi
#
#   if array::contains four "${list[@]}"; then
#       echo "four should not be found"
#       echo "'four four' with a space would be found"
#   fi
#
# Returns true (0) if $1 is found in the list of other arguments, false (1)
# otherwise.
array::contains() {
    local check needle

    needle=$1
    shift 1

    for check in "$@"; do
        if [[ "$needle" == "$check" ]]; then
            return 0
        fi
    done

    return 1
}


# Check if a value is in an array.  If the value is found, the index within
# the array is assigned to the destination variable and this returns true.
# If it is not in the array, nothing is assigned and the function returns
# an error.
#
# $1    - Destination value for storing the index that is found.
# $2    - The value to seek in the array.
# $3-$@ - Array elements.
#
# The destination variable is only set when the element is found.
#
# Examples
#
#   local index list
#
#   list=(one two three "four four")
#
#   if array::indexOf index one "${list[@]}"; then
#       # This one works
#       echo "one is found at index $index"
#   fi
#
#   if array::indexOf index four "${list[@]}"; then
#       echo "four should not be found"
#       echo "'four four' with a space would be found"
#       echo "\$index will not be updated"
#   fi
#
# Returns success if $1 is found in the list of other arguments.
array::indexOf() {
    local check index needle target

    target=${1-}
    needle=${2-}
    shift 2
    index=0

    for check in "$@"; do
        if [[ "$needle" == "$check" ]]; then
            local "$target" && assign::value "$target" "$index"

            return 0
        fi

        index=$((index + 1))
    done

    return 1
}


# Join / implode an array
#
# $1    - Variable name to receive the joined content
# $2    - Joiner
# $3-$@ - Elements to join
#
# Returns nothing.
array::join() {
    local joiner result target

    target=${1-}
    joiner=${2-}
    shift
    shift
    printf -v result "$joiner%s" "$@"
    result=${result:${#joiner}}

    local "$target" && assign::value "$target" "$result"
}
bpm_include_path=$0
#!/usr/bin/env bash
. bpm
bpm::include assign
bpm::include log


# Resolves a directory. If you are given a relative path, this turns it into
# an absolute path.
#
# $1 - Destination variable name.
# $2 - Path to resolve.
# $3 - Path to resolve against (defaults to current directory).
#
# Returns true (0) when everything works. Returns false (1) when the directory
# does not exist (thus it can't be resolved). Returns false (2) when the
# path to resolve against does not exist.
path::absoluteDir() {
    local oldDir result

    oldDir=$PWD

    if [[ -n "${3-}" ]]; then
        cd "$3" 2> /dev/null || return 2
    fi

    cd "$2" 2> /dev/null || return 1
    result=$PWD
    cd "$oldDir"

    local "${1-}" && assign::value "$1" "$result"
}


# Equivalent to calling `dirname` but does not make a subshell, so this is
# roughly twice as fast.
#
# $1 - Destination variable name. This is set to the parent folder.
# $2 - Filename or directory name.
#
# Examples
#
#   path::dirname dest a/file/somewhere
#   echo "$dest"   # "a/file"
#
#   path::dirname dest ./filename
#   echo "$dest"   # "."
#
#   path::dirname dest filename
#   echo "$dest"   # "."
#
#   path::dirname dest some/dir/
#   echo "$dest"   # "some"
#
#   path::dirname dest dir/
#   echo "$dest"   # "."
#
# Returns nothing.
path::dirname() {
    local d p

    p=$2

    if [[ "${#p}" -gt 1 ]]; then
        p=${p%/}
    fi

    if [[ "$p" == */* ]]; then
        d=${p%/*}
        local "${1-}" && assign::value "$1" "${d:-/}"

        return
    fi

    local "${1-}" && assign::value "$1" "."
}


# Performs a single test for a target in the current directory or any parent.
# When found, supplies the folder name to the destination variable name. The
# location will be root-relative.
#
# $1 - Destination variable name.
# $2 - The type of test to perform.
# $3 - The target that you are testing.
#
# Examples:
#
#   # Search for a bpm.ini file in the current folder or any parent.
#   if ! path::findParentContaining result -f bpm.ini; then
#       echo "Sorry, did not find the file" >&2
#   else
#       echo "Folder containing file: $result"
#       echo "Full path: $result/bpm.ini"
#   fi
#
#   # Search for a particular library
#   path::findParentContaining -d bpm_modules/is
#
# Returning success and an empty string is a valid response, so make sure you
# use the return code from the function.
#
# Returns true (0) if the target was found.
path::findParentContaining() {
    local dir

    dir=$PWD

    # Scan parent folders for `bpm.ini`.
    while true; do
        # Nasty use of eval, but necessary. Alternatives are welcome.
        if eval [[ "$2" "$dir/$3" ]]; then
            log::debug "Found target $2: $dir/$3"
            local "${1-}" && assign::value "$1" "$dir/$3"

            return 0
        fi

        if [[ -z "$dir" ]]; then
            log::debug "Did not find target $2: $3"

            return 1
        fi

        log::debug "Target $2 not found in folder: $dir"
        dir=${dir%/*}
    done
}
bpm_include_log=$0
#!/usr/bin/env bash

. bpm
bpm::include array
bpm::include string

# This logging function helps diagnose errors or provide additional details
# about what's happening in your scripts.  Use this to log every action that is
# performed.  Debug output can be enabled by setting the `DEBUG` environment
# variable.  When enabled, debug output is written to `stderr` and are also
# passed to `log::toFile` so they could be written to a log file. This also
# will colorize the output when the `LOG_COLOR` environment variable is set to
# a non-empty string.
#
# $@         - The message to log.  Arguments are joined into one line.
# $DEBUG     - Controls if logging is enabled and where it's enabled.
# $LOG_COLOR - When set to non-empty string, ANSI color is enabled.
#
# When the DEBUG environment variable is not set, debug is disabled.  If DEBUG
# is set to `*`, `all` or `true`, this always logs.  In all other cases, DEBUG
# is assumed to be either a name of a function or a list of function names that
# should have debug logging enabled.  When FUNCNAME lists one of these
# functions, logging will happen.  This means you can turn on logging for one
# function and logging is enabled for that function and for all code that the
# function will execute, so child functions will also write debug output.
#
# Writing to `stderr` is intentional.  This way you can enable debugging and
# still get valid output captured.
#
# Examples
#
#   # Forcibly disable all logging.
#   DEBUG= ./thing
#
#   # Enable all debugging (two methods).
#   DEBUG=true ./thing
#   DEBUG="*" ./thing
#
#   # Enable logging for a function named "doMagic".
#   DEBUG=doMagic ./thing
#
#   # Enable logging for the functions "rainbow", "pony" and "unicorn".
#   DEBUG="rainbow pony unicorn" ./thing
#
#   # Enable debug logging for all subsequent commands.
#   export DEBUG=true
#   ./thing1
#   ./thing2
#
# Returns nothing.
log::debug() {
    # Do not log unless DEBUG environment variable is set.
    [[ -z "${DEBUG-}" ]] || (
        set +x
        # Disable debug in this function.  Note: this function uses a subshell!

        local content list name output

        array::join content " " "$@" || return $?
        string::prefixLines output "DEBUG: " "$content" || return $?

        if [[ -n "${LOG_COLOR-}" ]]; then
            output=$'\E[90;1m'"$output"$'\E[0m'
        fi

        # Check if debugging is enabled for everything
        if [[ "$DEBUG" == "*" ]] || [[ "$DEBUG" == "true" ]]; then
            log::toFile "DEBUG" "$content" || return $?
            echo "$output" >&2

            return
        fi

        #: Here is the more complex checking if any value in the DEBUG variable
        #: is in the FUNCNAME array.
        list="$DEBUG"

        while [[ -n "$list" ]]; do
            name=${DEBUG%% *}
            list=${list#* }

            if [[ "$list" == "$name" ]]; then
                list=""
            fi

            if [[ -n "$name" ]] && [[ ${#FUNCNAME[@]} -gt 0 ]]; then
                if array::contains "$name" "${FUNCNAME[@]}"; then
                    log::toFile "DEBUG" "$content" || return $?
                    echo "$output" >&2

                    return
                fi
            fi
        done
    )
}


# Logging function for errors.  Use this to log error messages right before you
# exit the program or return a failure.  All messages are written to `stderr`.
# Log messages are also passed to the `log::toFile` function to be logged to a
# file.  (See `log::toFile` for information about log files.) This also
# will colorize the output when the `LOG_COLOR` environment variable is set to
# a non-empty string.
#
# $@         - The message to log.  Arguments are joined into one line.
# $LOG_COLOR - Colorizes output when set to a non-empty string.
#
# Examples
#
#    log::error "Could not find some vital thing"
#
#    exit 1
#
# Returns nothing.
log::error() {
    (
        set +x
        # Disable debug in this function.  Note: this function uses a subshell!

        local content output

        array::join content " " "$@" || return $?
        log::toFile "ERROR" "$content" || return $?
        string::prefixLines output "ERROR: " "$content" || return $?

        if [[ -n "${LOG_COLOR-}" ]]; then
            output=$'\E[41;37;1m'"$output"$'\E[0m'
        fi

        echo "$output" >&2
    )
}


# Writes an informational message to the logging system.  Informational
# messages are written to `stdout` unless `$LOG_QUIET` is set to a non-empty
# value.  The message is also sent to `log::toFile` for possible output to a
# log file.  See `log::toFile` for information regarding logfiles.  When
# `$LOG_COLOR` is set to a non-empty string, the output is also colorized.
#
# $@          - The message to write.  Arguments are joined into one line.
# $LOG_COLOR  - When set to a non-empty value, the output is colorized.
# $_LOG_QUIET - When set to a non-empty value, the output is suppressed.
#
# Returns nothing.
log::info() {
    (
        set +x
        # Disable debug in this function.  Note: this function uses a subshell!

        local content output

        array::join content " " "$@" || return $?
        log::toFile INFO "$content" || return $?

        if [[ -z "${LOG_QUIET-}" ]]; then
            string::prefixLInes output "INFO: " "$content" || return $?

            if [[ -n "${LOG_COLOR-}" ]]; then
                output=$'\E[32m'"$output"$'\E[0m'
            fi

            echo "$output"
        fi
    )
}


# Write a log message to a file or to a logging system.  Used by `log::debug`,
# `log::info`, `log::warn` and `log::error`.  Should not be used directly.
#
# $1       - Log level. One of ERROR WARN INFO DEBUG.
# $2       - The message to write.
# $LOGFILE - Destination for log messages.
#
# Uses the environment variable `$LOGFILE` to determine where to log
# messages.  Will write a timestamped messsage to that file, creating the file
# if necessary.
#
# If `$LOGFILE` starts with "syslog:", this will use the `logger` command to
# write a line to syslogd.  The facility defaults to user, but you can use any
# facility; for example you can use the mail facility by setting
# `LOGFILE="syslog:mail"`.  Additionally you can set a the tag by adding a
# second ":" followed by the desired tag; for example you can set the tag to
# myapp by setting `LOGFILE="syslog::myapp".
#
# Otherwise, `$LOGFILE` should be set to a filename.  Messages are
# prefixed with a timestamp.
#
# Examples
#
#   # Send output to /var/log/messages
#   LOGFILE=/var/log/messages ./your-command
#
#   # Send messages to /var/log/syslog using the daemon facility
#   LOGFILE=syslog:daemon ./my-background-thing
#
#   # Send messages to syslog using the "user" facility (default) and
#   # tagging them with "awesome"
#   LOGFILE=syslog::awesome
#
# Returns nothing.
log::toFile() {
    local logLevel output facility priority tag

    logLevel=$1

    if [[ -z "${LOGFILE-}" ]]; then
        return
    fi

    if [[ "${LOGFILE:0:7}" == "syslog:" ]]; then
        facility=${LOGFILE:7}
        tag=${facility#*:}

        if [[ "$facility" == "$tag" ]]; then
            tag=""
        fi

        facility=${facility%%:*}

        if [[ -z "$facility" ]]; then
            facility="user"
        fi

        case "$logLevel" in
            ERROR)
                priority="err"
                ;;

            WARN)
                priority="warning"
                ;;

            INFO)
                priority="info"
                ;;

            DEBUG)
                priority="debug"
                ;;
        esac

        loggerCmd=(logger -p "$facility"."$priority") || return $?

        if [[ -n "$tag" ]]; then
            loggerCmd[${#loggerCmd[@]}]=-t
            loggerCmd[${#loggerCmd[@]}]=$tag
        fi

        loggerCmd[${#loggerCmd[@]}]=--
        loggerCmd[${#loggerCmd[@]}]=$2
        "${loggerCmd[@]}"
    elif [[ -n "${LOGFILE-}" ]]; then
        string::prefixLines output "$(date -Iseconds) $logLevel: " "$2" || return $?
        echo "$output" >> "$WICK_LOGFILE"
    fi
}


# Logging for warnings, such as when problems are detected and they aren't
# severe enough to warrant an error and termination of the function.  Warning
# messages are always written to `stderr`.  See `log::toFile` for information
# about writing log messages to files.  This also colorizes the output when
# `$LOG_COLOR` is set to a non-empty value.
#
# $@         - The text to log.  Arguments are appended into a single line.
# $LOG_COLOR - When set to a non-empty string the output is colorized.
#
# Examples
#
#   if [[ -f /some/file ]]; then
#       log::warn "File exists when it should not."
#       rm /some/file
#   fi
#
# Returns nothing.
log::warn() {
    (
        set +x
        # Disable debug in this function.  Note: this function uses a subshell!

        local content output

        array::join content " " "$@" || return $?
        log::toFile "WARN" "$content" || return $?
        string::prefixLines output "WARN: " "$content" || return $?

        if [[ -n "${LOG_COLOR-}" ]]; then
            output=$'\E[33;1m'"$output"$'\E[0m'
        fi

        echo "$output" >&2
    )
}
bpm_include_ini=$0
#!/usr/bin/env bash

. bpm
bpm::include array
bpm::include assign
bpm::include string
bpm::include is


# Retrieves a list of sections, list of keys, or a key's value.
#
# $1 - Target variable.
# $2 - Prefix, required.
# $3 - Section, optional. Required if you want to access a key.
# $4 - Key name, optional
#
# Examples
#
#   # Assume the following INI file:
#   #
#   # [sectionName]
#   # keyName = theValue
#
#   ini::parse INI "$iniFileContents"
#   ini::get target INI
#   set | grep ^target=
#   # target=([0]="" [1]="sectionName")
#
#   ini::get target INI sectionName
#   set | grep ^target=
#   # target=([0]="keyName")
#
#   ini::get target INI sectionName keyName
#   # target="theValue"
#
# Returns nothing
ini::get() {
    local keyName target value

    target=${1-}
    shift

    # shellcheck disable=SC2068
    ini::keyName keyName "$@"

    if [[ "$#" -lt 3 ]]; then
        if [[ -z "${!keyName+_}" ]]; then
            value=()
        else
            # shellcheck disable=SC1087
            eval "value=( \${$keyName[@]+\"\${$keyName[@]}\"} )"
        fi

        # shellcheck disable=SC2068
        local "$target" && assign::array "$target" ${value[@]+"${value[@]}"}
    else
        local "$target" && assign::value "$target" "${!keyName-}"
    fi
}


# Encode a prefix, section and key in order to generate a safe variable name
# for Bash. All section names and key names are case insensitive.
#
# $1 - Prefix for environment variables, required.
# $2 - Section, optional. Required if you want to access a key.
# $3 - Key name, optional.
ini::keyName() {
    local name part target

    target="$1"
    shift
    name="$1"

    if [[ $# -gt 1 ]]; then
        string::toUpper part "$2"
        string::toHex part "$part"
        name+="_$part"

        if [[ $# -gt 2 ]]; then
            string::toUpper part "$3"
            string::toHex part "$part"
            name+="_$part"
        fi
    fi

    local "$target" && assign::value "$target" "$name"
}


# Parses an INI file into the environment.
#
# $1 - Prefix for environment variables that will be assigned.
# $2 - INI file contents
#
# Variables are stored in memory, encoded in hex to ensure the variable names
# are valid variables.
#
#   PREFIX=(array of unencoded section names)
#   PREFIX_SECTIONENCODED=(array of unencoded key names)
#   PREFIX_SECTIONENCODED_KEYENCODED=value
#
# You should not use these environment variables directly. Instead, use the
# other utility functions to access the values.
#
#     $1: Prefix for variables.
#     $2: INI file contents
ini::parse() {
    local encodedKey encodedSection key keys line oldIfs prefix section sections value

    prefix=$1
    sections=("")
    section=
    keys=()
    ini::keyName encodedSection "$prefix" "$section"
    oldIfs=$IFS
    IFS=$'\n'

    while read line; do
        string::trim line "$line"

        #: Eliminate comments starting with # or ;
        line=${line#\#*}
        line=${line#;*}

        if [[ "${line:0:1}" == '[' ]] && [[ "${line:${#line}-1}" == "]" ]]; then
            #: Remove brackets
            line=${line:1:${#line}-2}

            # Save the previously loaded section
            # shellcheck disable=SC2068
            assign::array "$encodedSection" ${keys[@]+"${keys[@]}"}

            string::trim section "$line"
            ini::keyName encodedSection "$prefix" "$section"

            # shellcheck disable=SC2068
            if ! array::contains "$section" ${sections[@]+"${sections[@]}"}; then
                # Track the new section
                sections[${#sections[@]}]=$section
                keys=()
            else
                # Load the repeated section. Sorry for the eval.
                # shellcheck disable=SC1087
                eval "keys=( \${$encodedSection[@]+\"\${$encodedSection[@]}\"} )"
            fi
        elif [[ -n "$line" ]]; then
            IFS="=" read key value <<< "$line"
            string::trim key "$key"

            if [[ -n "$key" ]]; then
                string::trim value "$value"
                ini::keyName encodedKey "$prefix" "$section" "$key"
                assign::value "$encodedKey" "$value"

                # shellcheck disable=SC2068
                if ! array::contains "$key" ${keys[@]+"${keys[@]}"}; then
                    keys[${#keys[@]}]=$key
                fi
            fi
        fi
    done <<< "$2"

    IFS=$oldIfs

    # shellcheck disable=SC2068
    assign::array "$encodedSection" ${keys[@]+"${keys[@]}"}

    # shellcheck disable=SC2068
    assign::array "$prefix" ${sections[@]+"${sections[@]}"}
}


# Generates a unique INI file prefix that has not yet been used.
#
# $1 - Destination variable name for the INI prefix.
#
# Returns nothing.
ini::prefix() {
    local prefix

    #: 1 in 32k
    prefix="ini_${RANDOM}"

    while is::set "$prefix"; do
        #: 1 in 1 billion
        prefix="ini_${RANDOM}_${RANDOM}"
    done

    local "$1" && assign::value "$1" "$prefix"
}
# Sets the PATH environment variable to add the following values, in this
# order:
#
# 1. The `bpm/.bin` folder in the current directory or the first parent that
#    contains a `bpm.ini` file.
# 2. The user's `~/.bpm/.bin` folder.
# 3. The system's `/usr/lib/bpm/.bin` folder.
# 4. The rest of the existing PATH.
#
# To accomplish this, we simply work backwards and prepend new paths.
#
# Returns nothing.
bpm::addLocationsToPath() {
    local ini

    # Add the system location
    bpm::prependToPath /usr/lib/bpm/.bin "global libraries"
    bpm::prependToPath ~/.bpm-modules/.bin "user libraries"
    bpm::findParentIni ini

    if [[ -n "$ini" ]]; then
        bpm::prependToPath "${ini%/*}/bpm-modules/.bin" "project libraries"
    fi
}


# Adds a package to the list of packages to install.
#
# $1 - Package name.
# $2 - Package version specification.
#
# Alters BPM_INSTALL_LIST array to include the package name, without
# duplication.
#
# Returns true (0) on success. Returns 1 when there is a conflict of version
# specifications.
bpm::addToInstallList() {
    local versionVar

    string::toHex versionVar "$1"
    versionVar="BPM_INSTALL_LIST_$versionVar"

    # shellcheck disable=SC2068
    if array::contains "$1" ${BPM_INSTALL_LIST[@]+"${BPM_INSTALL_LIST[@]}"}; then
        if [[ "${!versionVar}" != "$2" ]]; then
            log::error "Package $1 already flagged to be installed, but with a different version."
            log::error "Need: ${!versionVar}"
            log::error "Also need: $2"

            return 1
        fi
    fi

    BPM_INSTALL_LIST[${#BPM_INSTALL_LIST[@]}]=$1
    assign::value "$versionVar" "$2"
}


# The body of the BPM command line program
#
# $@ - Arguments passed on the command line.
#
# Returns true (0) on success. Returns 1 when no command was passed. Returns
# 2 when an unknown command was issued.
bpm() {
    local command

    if [[ -z "${1-}" ]]; then
        echo "Specify a command to run. Use 'bpm help' to see a list of commands." >&2

        return 1
    fi

    command=$1
    shift

    case "$command" in
        help)
            # shellcheck disable=SC2068
            bpm::help ${@+"$@"}
            ;;

        install)
            # shellcheck disable=SC2068
            bpm::install ${@+"$@"}
            ;;

        run)
            # shellcheck disable=SC2068
            bpm::run ${@+"$@"}
            ;;

        version)
            bpm::version
            ;;

        *)
            echo "Unknown command: $command" >&2
            echo "Use 'bpm help' to get a list of commands." >&2

            return 2
            ;;
    esac
}



# Use the version specifier and download or copy the files into the modules
# folder.
#
# $1 - Library directory for installation.
# $2 - Package name.
# $3 - Package version specifier.
#
# Returns true (0) on success. Returns 1 if there was any problem that's
# a file system level (can't make a directory, can't copy a file). Returns
# 2 if the package could not be downloaded or if the download method is
# unable to be determined. Returns 3 if the archive could not be expanded or
# if there is invalid library information encountered.
bpm::downloadPackage() {
    if [[ "$3" == "*" ]]; then
        bpm::downloadPackageFromRegistry "$1" "$2" "$3"
    elif [[ -d "$3" ]]; then
        bpm::downloadPackageFromDirectory "$1" "$2" "$3"
    elif [[ -f "$3" ]]; then
        bpm::downloadPackageFromFile "$1" "$2" "$3"
    elif [[ "$3" == *://* ]]; then
        bpm::downloadPackageFromHttp "$1" "$2" "$3"
    else
        log::error "Unable to download package $2: $3"
        log::error "No known method of download."

        return 2
    fi
}



# Downloads a package from a local directory.
#
# $1 - Library directory for installation.
# $2 - Package name.
# $3 - Package version specifier.
#
# Returns true (0) on success. Returns 1 if the folder can not be copied.
bpm::downloadPackageFromDirectory() {
    local dest

    dest="$1/$2"
    log::debug "Copying folder: $3"
    cp -r "$3" "$dest" || return 1
    bpm::fixPackageNesting "$dest"
}



# Downloads a package from a given archive file.
#
# $1 - Library directory for installation.
# $2 - Package name.
# $3 - Package version specifier.
#
# Returns true (0) on success. Returns 1 for filesystem level errors (can't
# make a directory, can't copy a file). Returns 3 when the archive can not be
# expanded.
bpm::downloadPackageFromFile() {
    local dest

    dest="$1/$2"
    log::debug "Copying file: $3"
    mkdir -p "$dest" || return 1
    cp "$3" "$dest/.bpm-archive" || return 1
    bpm::expandArchive "$dest" ".bpm-archive" || return 3
    rm "$dest/.bpm-archive" || return 1
    bpm::fixPackageNesting "$dest"
}



# Downloads a package from the package registry.
#
# $1 - Library directory for installation.
# $2 - Package name.
# $3 - Package version specifier.
#
# Returns true (0) on success. Returns 1 when there is a strange error, such
# as not being able to make a folder. Returns 2 if there's a download problem.
# Returns 3 if the archive can not be expanded.
bpm::downloadPackageFromHttp() {
    local dest

    dest="$1/$2"
    mkdir -p "$dest" || return 1
    log::debug "Downloading: $3"
    bpm::getUrl "$3" > "$dest/.bpm-archive" || return 2
    bpm::expandArchive "$dest" ".bpm-archive" || return 3
    rm "$dest/.bpm-archive" || return 1
    bpm::fixPackageNesting "$1/$2"
}



# Downloads a package from the package registry.
#
# $1 - Library directory for installation.
# $2 - Package name.
# $3 - Package version specifier.
#
# Returns true (0) on success. Returns 1 if there is a strange filesystem
# error (can't copy, can't make directory). Returns 2 when the files can't be
# downloaded. Returns 3 if there is no download URL in the package's
# descriptor.
bpm::downloadPackageFromRegistry() {
    local definitionPrefix dest iniData url

    # Download INI from website
    log::debug "Loading package information from registry: $2"
    iniData=$(bpm::getUrl "https://rawgit.com/bpm-rocks/registry/master/packages/$2.ini" || :)

    if [[ -z "$iniData" ]]; then
        log::error "Unable to download package information from registry. Package not found."

        return 3
    fi

    # Parse INI, get download URL to .tar.gz
    ini::prefix definitionPrefix
    ini::parse "$definitionPrefix" "$iniData"
    ini::get url "$definitionPrefix" "$2" downloadUrl

    if [[ -z "$url" ]]; then
        log::error "No 'downloadUrl' property in package's information."

        return 3
    fi

    dest="$1/$2"
    mkdir -p "$dest" || return 1
    log::debug "Downloading: $url"
    bpm::getUrl "$url" > "$dest/.bpm-archive"
    bpm::expandArchive "$dest" ".bpm-archive"
    rm "$dest/.bpm-archive" || return 1
    bpm::fixPackageNesting "$dest"
}



# Decompresses a compressed file. Decompressed files are left in the same
# folder as the archive.
#
# $1 - Folder location.
# $2 - Archive file.
#
# This simply tries running all of the decompressors on the file, stopping
# if one works and does not return an error. An alternative would be using
# `file`, but that is not well supported across systems.
#
# Returns true (0) on success. Returns 1 if the archive type could not be
# determined. Returns 2 if there's a problem during extraction, such as
# being unable to write files.
bpm::expandArchive() {
    (
        cd "$1"

        if unzip -t "$2" &> /dev/null; then
            log::debug "Detected zip file archive."
            unzip "$2" &> /dev/null || return 2

            return 0
        fi

        # This can work for .gz and .bz2 files.
        if tar tf "$2" &> /dev/null; then
            log::debug "Detected tar archive."
            tar xf "$2" || return 2

            return 0
        fi

        # Just in case the above does not work.
        if tar tfz "$2" &> /dev/null; then
            log::debug "Detected tar.gz archive."
            tar xfz "$2" || return 2

            return 0
        fi

        if tar tfj "$2" &> /dev/null; then
            log::debug "Detected tar.bz2 archive."
            tar xfj "$2" || return 2

            return 0
        fi

        log::debug "Unable to determine archive format."

        return 1
    )
}


# Finds a `bpm.ini` file in the current directory or any parent. When found,
# this will send the INI file location to the destination variable name.  The
# INI file location will be root-relative (you'll see `/folder/dir/bpm.ini`
# instead of `../bpm.ini`.
#
# Returns true (0) if `bpm.ini` was found.
bpm::findParentIni() {
    local result

    path::findParentContaining result -f "bpm.ini" || return 0

    local "${1-}" && assign::value "$1" "$result"
}



# If the specified folder has only one entry and it's a directory, move the
# contents of that directory into the parent. This is useful when an archive is
# extracted and it contains all files within a parent folder.
#
# $1 - Path name to check.
#
# Returns true (0) upon success. Returns 1 when the specified directory does
# not exist or if it is not a directory.
bpm::fixPackageNesting() {
    local files restoreDotglob tempDir

    if [[ ! -d "$1" ]]; then
        log::error "Not a directory: $1"

        return 1
    fi

    restoreDotglob=$(shopt -p dotglob)
    shopt -s dotglob
    files=("$1/"*)
    eval "$restoreDotglob"

    if [[ "${#files[@]}" -eq 1 && -d "${files[0]}" ]]; then
        log::debug "Unnesting: ${files[0]}"
        tempDir="$1.temp.$$"
        mv "${files[0]}" "$tempDir"
        rmdir "$1"
        mv "$tempDir" "$1"
    fi
}


# Downloads a file from the internet, pipes to stdout.
#
# $1 - URL.
#
# Returns an error if no usable tool was found.
bpm::getUrl() {
    if hash curl &> /dev/null; then
        curl --fail --silent --location "$1"
    elif hash wget &> /dev/null; then
        wget -O - "$1" 2> /dev/null
    else
        log::error "Unable to download - no supported tools exist."
        log::error "Please install curl or wget."

        return 1
    fi
}


# Display help messages for using BPM.
#
# $@ - Arguments passed on the command line.
#
# Returns true (0) on success. Returns 1 when a subtopic is requested but
# is not found.
bpm::help() {
    if [[ -n "${1-}" ]]; then
        if ! is::function "bpm::help::$1"; then
            echo "No such help topic. Use 'bpm help' to list the topics."

            return 1
        fi

        log::debug "Displaying help topic: $1"
        "bpm::help::$1"
    else
        log::debug "Displaying help"
        cat <<'EOF'
BPM - Bash Package Manager

Syntax:

    bpm <COMMAND> [ARGUMENTS]

Commands:

    help        Displays this help message.
    install [OPTIONS] [PACKAGE [VERSION]]
                When used without PACKAGE and OPTIONS, this installs the
                dependencies listed in bpm.ini. Otherwise, installs the
                specified package. Use the option -g or --global to install
                the packages globally.
    run <SCRIPT> [ARGUMENT [...]]
                Runs a specified script. When arguments are included, they
                are passed to the script.
    version     Display BPM version and build information.
EOF
    fi
}


# Installs a package or set of packages.
#
# $1 - Package specificiation. Optional. When not assigned a value, will
#      search for a `bpm.ini` file and install everything listed under the
#      `[dependencies]` and `[devDependencies]` sections.
#
# Determines the install location. This is passed on to other commands so they
# install further dependencies into the same location. `$binDir` is where
# wrapper scripts go for installed programs, `$libDir` is where the library
# will get installed.
#
# * For global installs (use -g or --global)
#     * `$libDir` is `/usr/lib/bpm`
#     * `$binDir` is `/usr/bin`
# * When there is a `bpm.ini` file in the current directory or any parent
#     * `$libDir` is `$bpmIniDir/bpm`
#     * `$binDir` is `$bpmIniDir/bpm/.bin`
# * Installs into a local user's directory
#     * `$libDir` is `~/.bpm`
#     * `$binDir` is `~/.bpm/.bin`
#
# See `bpm::installPackage()` for more details.
#
# This returns true (0) on success.
bpm::install() {
    local binDir iniFile libDir package versionVar

    BPM_INSTALL_LIST=()

    if [[ "$#" -eq 0 ]]; then
        if ! bpm::findParentIni iniFile; then
            log::error "No bpm.ini file found and not provided a name of a package to install."

            return 1
        fi

        log::debug "Install is using INI: $iniFile"
        bpm::packagesFromIni "$iniFile" dependencies
        bpm::packagesFromIni "$iniFile" devDependencies
        libDir="${iniFile%/*}/bpm-modules"
        binDir="$libDir/.bin"
    else
        if bpm::findParentIni iniFile; then
            libDir="${iniFile%/*}/.bpm"
            binDir="$libDir/.bin"
        else
            libDir=~/.bpm
            binDir=~/.bpm/.bin
        fi

        while [[ "$#" -gt 0 ]]; do
            case "$1" in
                -g|--global)
                    log::debug "Installing to a global location"
                    libDir=/usr/lib/bpm
                    binDir=/usr/bin
                    ;;

                -*)
                    log::warn "Unknown option: $1"

                    return 1
                    ;;

                *)
                    log::debug "Install is using a package name: $1"
                    bpm::addToInstallList "$1" "${2:-*}"
                    ;;
            esac

            shift
        done
    fi

    # Now install everything
    if [[ "${#BPM_INSTALL_LIST[@]}" -gt 0 ]]; then
        for package in "${BPM_INSTALL_LIST[@]}"; do
            string::toHex versionVar "$package"
            versionVar="BPM_INSTALL_LIST_$versionVar"
            bpm::installPackage "$libDir" "$binDir" "$package" "${!versionVar}"
        done
    else
        log::debug "No packages to install."
    fi
}


# Installs a package or set of packages.
#
# $1 - Library directory for installation.
# $2 - Bin directory for installation.
# $3 - Package name.
# $4 - Package version specifier.
#
# Packages are checked for executable programs and file includes when being
# installed. The executables are placed in `$BIN_DIR` and the includes go
# into `$PREFIX/.include`.
#
# * When installing globally, `$PREFIX` is `/usr/lib/bpm/` and `$BIN_DIR` is
#   `/usr/bin/`.
# * If there is a `bpm.ini` file in the current directory or any parent, the
#   `$PREFIX` is set to the dirname of the file with "bpm/" appended. For
#   example, when `/home/user/project/bpm.ini` is detected, `$PREFIX` is
#   `/home/user/project/bpm/`. `$BIN_DIR` is `$PREFIX/.bin`.
# * Finally, when all else fails, use `~/.bpm/` as `$PREFIX` and `$BIN_DIR`
#   is `$PREFIX/.bin`.
#
# The package will be installed to `$PREFIX/$LIBRARY/`. After installation, the
# `bpm.ini` package descriptor is scanned and the following actions will be
# taken.
#
# * All packages under the `[dependencies]` section are installed to
#   `$PREFIX/`. This installation logic is repeated for each of them.
# * The `[package]` section is checked for an `include` key. If found, a file
#   is written to `$PREFIX/.include/$LIBRARY` that will load the necessary
#   files in the library.
# * If there is a `[install]` section, all of the keys will generate
#   executable wrapper scripts. The wrappers will be created as
#   `$BIN_DIR/$COMMAND_NAME`.
#
# This returns true (0) on success. Returns 1 if there is any issue downloading
# the package.
bpm::installPackage() {
    local dependencies package packagePrefix version

    # See if it is already installed.
    if [[ -d "$1/$3" ]]; then
        log::debug "Package already installed: $3"

        return 0
    fi

    echo "Installing $3"

    if ! bpm::downloadPackage "$1" "$3" "$4"; then
        log::error "Error downloading package."
        rm -rf "${1:?}/$2"

        return 1
    fi

    # Parse the INI
    ini::prefix packagePrefix

    if [[ -f "$1/$3/bpm.ini" ]]; then
        log::debug "Loading package INI."
        ini::parse "$packagePrefix" "$(cat "$1/$3/bpm.ini")"
    else
        log::debug "No package INI file. Faking an empty config."
    fi

    # Install
    bpm::linkIncludeFile "$1" "$3" "$packagePrefix"
    bpm::linkPrograms "$1" "$2" "$3" "$packagePrefix"

    # Install any dependencies
    ini::get dependencies "$packagePrefix" dependencies

    if [[ "${#dependencies[@]}" ]]; then
        for package in "${dependencies[@]}"; do
            ini::get version "$packagePrefix" dependencies "$package"
            bpm::installPackage "$1" "$2" "$package" "$version"
        done
    fi
}


# Creates a loader wrapper in order to load a package.
#
# $1 - Library folder.
# $2 - Package name.
# $3 - INI prefix.
#
# Returns nothing.
bpm::linkIncludeFile() {
    local include

    ini::get include "$3" package include

    if [[ -z "$include" ]]; then
        log::debug "No 'package.include' setting in INI file."

        return 0
    fi

    if [[ ! -f "$1/$2/$include" ]]; then
        log::error "Library wants to include $include but file does not exist."

        return 1
    fi

    if [[ ! -d "$1/.include" ]]; then
        mkdir "$1/.include"
    fi

    log::debug "Writing wrapper .include/$2 -> $2/$include"
    cat > "$1/.include/$2" <<EOF
#!/usr/bin/env bash
# Generated include file for bpm
pushd "\${BASH_SOURCE[0]%/*}/../$2" &>/dev/null
. "./$include"
popd &> /dev/null
EOF
}


# Creates a loader wrapper in order to load a package.
#
# $1 - Library folder.
# $2 - Bin folder.
# $3 - Package name.
# $4 - INI prefix.
#
# Returns nothing.
bpm::linkPrograms() {
    local dest libFolderResolved oldPwd programs src

    ini::get programs "$4" install

    if [[ "${#programs[@]}" -eq 0 ]]; then
        log::debug "No 'install' setting in INI file."

        return 0
    fi

    # This is necessary to support for globally installed packages.
    oldPwd=$PWD
    cd "$1/$3"
    libFolderResolved=$PWD
    cd "$oldPwd"

    for src in "${programs[@]}"; do
        ini::get dest "$4" install "$src"

        if [[ -z "$dest" ]]; then
            log::error "Destination is empty for program: $src"

            return 1
        fi

        if [[ ! -f "$1/$3/$dest" ]]; then
            log::error "File does not exist: $1/$3/$dest"

            return 1
        fi

        if [[ ! -d "$2" ]]; then
            mkdir -p "$2"
        fi

        src=${dest##*/}
        log::debug "Writing program wrapper $src -> $3/$dest"
        cat > "$2/$src" <<EOF
#!/usr/bin/env bash
# Generated command file for bpm
"$libFolderResolved/$dest" \${@+"\$@"}
EOF
        chmod 755 "$2/$src"
    done
}


# Loads an INI file and gets the packages from it that are necessary for
# installation.
#
# $1 - INI file location.
# $2 - Section name (`dependencies` or `devDependencies`).
#
# This returns true (0) on success.
bpm::packagesFromIni() {
    local iniPrefix package packages version

    log::debug "Loading bpm.ini: $1"
    ini::prefix iniPrefix
    ini::parse "$iniPrefix" "$(cat "$1")"
    log::debug "Loading section: $2"
    ini::get packages "$iniPrefix" "$2"

    if [[ "${#packages[@]}" -gt 0 ]]; then
        for package in "${packages[@]}"; do
            ini::get version "$iniPrefix" "$2" "$package"
            bpm::addToInstallList "$package" "$version" || return 1
        done
    fi
}


# Checks if a directory exists. If it does, prepend the folder to the PATH.
#
# $1 - Folder path.
# $2 - Description.
#
# Returns nothing.
bpm::prependToPath() {
    local oldPwd

    if [[ ! -d "$1" ]]; then
        log::debug "No $2 folder found"

        return
    fi

    # Find the resolved location
    oldPwd=$PWD
    cd "$1"
    log::debug "Prepending $2 to path: $PWD"
    PATH="$PWD:$PATH"
    cd "$oldPwd"
}


# Runs a script as defined in a `bpm.ini` file after setting up the PATH
# to include, in this order:
#
# 1. The `bpm/.bin` folder in the current directory or the first parent that
#    contains a `bpm.ini` file.
# 2. The user's `~/.bpm/.bin` folder.
# 3. The system's `/usr/lib/bpm/.bin` folder.
# 4. The rest of the existing PATH.
#
# The command is looked up in `bpm.ini` and is executed. Any additional
# arguments specified on the command line are appended to the defined command.
#
# Returns the result from running the command. Can return an error status
# (not zero) when errors are detected.
bpm::run() {
    local cmd iniFile iniPrefix list scriptToRun

    if ! bpm::findParentIni iniFile; then
        echo "Unable to find bpm.ini." >&2

        return 1
    fi

    log::debug "Loading bpm.ini: $iniFile"
    ini::prefix iniPrefix
    ini::parse "$iniPrefix" "$(cat "$iniFile")"

    if [[ -z "$1" ]]; then
        ini::get list "$iniPrefix" scripts

        if [[ "${#list[@]}" -eq 0 ]]; then
            echo "There are no scripts defined in $iniFile."
        else
            echo "Commands in $iniFile:"
            echo ""

            for cmd in "${list[@]}"; do
                ini::get scriptToRun "$iniPrefix" scripts "$cmd"
                echo "$cmd=$scriptToRun"
            done
        fi

        return 0
    fi

    ini::get cmd "$iniPrefix" scripts "$1"

    if [[ -z "$cmd" ]]; then
        echo "Command does not exist in $iniFile: $1" >&2
        echo "See 'bpm run' for a list of commands." >&2

        return 2
    fi

    # Remove the first argument to bpm::run so we're left with only the extra
    # arguments.
    shift
    bpm::addLocationsToPath

    # Go to the directory containing `bpm.ini` so there's a consistent place
    # where the command is executed.
    cd "${iniFile%/*}"

    # Display the command to be executed.
    echo "$cmd $*"

    # Add the extra arguments to the command that's being executed.
    # shellcheck disable=SC2068
    eval "$cmd ; exit \$?"
}


# Show BPM's build date and version.
#
# Returns nothing.
bpm::version() {
    local buildDate var

    buildDate=${BPM_BUILD_DATE/T/ }
    printf "# BPM - Bash Package Manager, version %s, built %s UTC\n" "$BPM_VERSION" "${buildDate%+*}"

    for var in BASH_VERSION BPM_BUILD_DATE BPM_VERSION; do
        printf "%s=%q\n" "$var" "${!var}"
    done
}



# Run the main program
# shellcheck disable=SC2068
bpm ${@+"${@}"}

# Thanks!
